<!DOCTYPE html><html lang="es" style="--accentColor: #8ad6ff;--accentColor2: #72f0d5;"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Proyecto 13 ¬∑ Modelos de colas en servicios en la nube (M/M/c)</title><meta name="description" content="Evaluaci√≥n de rendimiento y asignaci√≥n de recursos con llegadas Poisson, servicios exponenciales y m√∫ltiples servidores."><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Manrope:wght@400;600&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script><script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script><link rel="stylesheet" href="/_astro/13.CrL8Mm4X.css">
<style>.hero[data-astro-cid-bbe6dxrz]{margin-top:40px;padding:clamp(24px,5vw,48px);border:1px solid var(--border);border-radius:24px;background:linear-gradient(135deg,#ffffff0a,#ffffff03);display:grid;grid-template-columns:1.2fr 1fr;gap:clamp(20px,4vw,32px);box-shadow:var(--shadow)}.hero__copy[data-astro-cid-bbe6dxrz] h1[data-astro-cid-bbe6dxrz]{font-size:clamp(26px,3.5vw,38px);margin-top:8px}.hero__copy[data-astro-cid-bbe6dxrz] .lede[data-astro-cid-bbe6dxrz]{margin:12px 0 18px;max-width:600px}.hero__panel[data-astro-cid-bbe6dxrz]{border:1px solid var(--border);border-radius:18px;background:linear-gradient(160deg,var(--surface),var(--surface-2));padding:18px;display:grid;gap:12px}.panel__header[data-astro-cid-bbe6dxrz]{display:flex;justify-content:space-between;align-items:center}.chip[data-astro-cid-bbe6dxrz],.bubble[data-astro-cid-bbe6dxrz]{padding:6px 12px;border-radius:10px;background:color-mix(in srgb,var(--accent) 10%,transparent);color:var(--accent);font-weight:700;font-size:12px}.bubble[data-astro-cid-bbe6dxrz].ghost{background:#ffffff0a;color:var(--muted);border:1px solid var(--border)}.status[data-astro-cid-bbe6dxrz]{color:var(--ink);font-weight:700}.panel__list[data-astro-cid-bbe6dxrz]{display:grid;gap:10px}.panel__item[data-astro-cid-bbe6dxrz]{padding:12px 14px;border-radius:12px;border:1px solid var(--border);background:#ffffff05}.panel__item[data-astro-cid-bbe6dxrz] .label[data-astro-cid-bbe6dxrz]{color:var(--muted);font-size:12px;display:block;margin-bottom:4px}.panel__item[data-astro-cid-bbe6dxrz] p[data-astro-cid-bbe6dxrz].accent{color:var(--accent)}.panel__footer[data-astro-cid-bbe6dxrz]{display:flex;gap:10px;flex-wrap:wrap}@media (max-width: 900px){.hero[data-astro-cid-bbe6dxrz]{grid-template-columns:1fr}}
</style>
<link rel="stylesheet" href="/_astro/13.Dzbh_5mT.css"><script type="module" src="/_astro/hoisted.QOdwnJaL.js"></script></head> <body style="--accent: #8ad6ff; --accent-2: #72f0d5;; --accentColor: #8ad6ff;--accentColor2: #72f0d5;"> <div class="page" style="--accentColor: #8ad6ff;--accentColor2: #72f0d5;">  <header class="topbar" data-astro-cid-axxsutmj> <div class="brand" data-astro-cid-axxsutmj> <div class="dot" data-astro-cid-axxsutmj></div> <span data-astro-cid-axxsutmj>Proyecto 13 ¬∑ M/M/c</span> </div> <nav data-astro-cid-axxsutmj> <a href="/" data-astro-cid-axxsutmj>Home</a><a href="#informe" data-astro-cid-axxsutmj>Informe</a><a href="#animacion" data-astro-cid-axxsutmj>Animaci√≥n</a><a href="#sim" data-astro-cid-axxsutmj>Simulador</a><a href="#codigo" data-astro-cid-axxsutmj>C√≥digo Python</a> </nav> </header>  <main data-astro-cid-kvyfnm2w> <section class="hero" data-astro-cid-bbe6dxrz> <div class="hero__copy" data-astro-cid-bbe6dxrz> <p class="eyebrow" data-astro-cid-bbe6dxrz>Tema 13</p> <h1 data-astro-cid-bbe6dxrz>Modelos de colas en servicios en la nube (M/M/c)</h1> <p class="lede" data-astro-cid-bbe6dxrz>Evaluaci√≥n de rendimiento y asignaci√≥n de recursos con llegadas Poisson, servicios exponenciales y m√∫ltiples servidores. Integra teor√≠a, simulaci√≥n y visualizaciones interactivas.</p> <div class="tags" data-astro-cid-bbe6dxrz> <span data-astro-cid-bbe6dxrz>Œª/Œº ¬∑ Erlang-C</span><span data-astro-cid-bbe6dxrz>SimPy + Streamlit</span><span data-astro-cid-bbe6dxrz>Cloud scaling</span> </div> <div class="cta" data-astro-cid-bbe6dxrz> <a class="primary" href="#sim" data-astro-cid-bbe6dxrz>Simulador M/M/c</a> <a class="ghost" href="#informe" data-astro-cid-bbe6dxrz>Ver presentaci√≥n</a> </div> </div> <div class="hero__panel" data-astro-cid-bbe6dxrz> <div class="panel__header" data-astro-cid-bbe6dxrz> <span class="chip" data-astro-cid-bbe6dxrz>Estado</span> <span class="status" data-astro-cid-bbe6dxrz>Preparado</span> </div> <div class="panel__list" data-astro-cid-bbe6dxrz> <div class="panel__item" data-astro-cid-bbe6dxrz> <span class="label" data-astro-cid-bbe6dxrz>Asignatura</span> <p data-astro-cid-bbe6dxrz>Procesos Estoc√°sticos y Series de Tiempo</p> </div><div class="panel__item" data-astro-cid-bbe6dxrz> <span class="label" data-astro-cid-bbe6dxrz>Modelo</span> <p data-astro-cid-bbe6dxrz>M/M/c ¬∑ Poisson(Œª), Exp(Œº), c servidores</p> </div><div class="panel__item" data-astro-cid-bbe6dxrz> <span class="label" data-astro-cid-bbe6dxrz>Herramientas</span> <p data-astro-cid-bbe6dxrz>SimPy ¬∑ Streamlit ¬∑ Plotly ¬∑ NumPy/Pandas</p> </div> </div> <div class="panel__footer" data-astro-cid-bbe6dxrz> <span class="bubble ghost" data-astro-cid-bbe6dxrz>Grupo 42</span><span class="bubble" data-astro-cid-bbe6dxrz>Colas ¬∑ Cloud</span> </div> </div> </section>  <section class="informe-carousel" id="informe" data-astro-cid-n5etzuft> <div class="section__head" data-astro-cid-n5etzuft> <div data-astro-cid-n5etzuft> <p class="eyebrow" data-astro-cid-n5etzuft>Informe</p> <h2 data-astro-cid-n5etzuft>Presentaci√≥n del Proyecto</h2> <p class="section__lede" data-astro-cid-n5etzuft>Naveg√° a trav√©s de las slides del an√°lisis completo.</p> </div> <div class="slide-nav-info" data-astro-cid-n5etzuft> <span class="slide-progress" data-astro-cid-n5etzuft>1 / 9</span> <span class="current-section" data-astro-cid-n5etzuft>Portada</span> </div> </div> <div class="informe-slider" data-astro-cid-n5etzuft> <div class="informe-slide" data-astro-cid-n5etzuft> <div class="slide-content" data-astro-cid-n5etzuft> <div class="slide-text" data-astro-cid-n5etzuft> <p class="slide-section" data-astro-cid-n5etzuft>Portada</p> <h3 class="slide-title" data-astro-cid-n5etzuft>Modelos de Colas M/M/c en la Nube</h3> <p class="slide-subtitle" data-astro-cid-n5etzuft>Evaluaci√≥n de Rendimiento y Asignaci√≥n de Recursos</p> <ul class="slide-bullets" data-astro-cid-n5etzuft> <li data-astro-cid-n5etzuft>Grupo G42 ¬∑ Noviembre 2025</li><li data-astro-cid-n5etzuft>Procesos Estoc√°sticos y Series de Tiempo</li><li data-astro-cid-n5etzuft>Universidad Mayor de San Andr√©s</li> </ul> </div> <div class="slide-image" data-astro-cid-n5etzuft> <img src="https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800&h=500&fit=crop" alt="" data-astro-cid-n5etzuft> </div> </div> </div> <div class="informe-controls" data-astro-cid-n5etzuft> <button class="nav-btn prev-btn" data-astro-cid-n5etzuft><span class="nav-icon" data-astro-cid-n5etzuft>‚Üê</span><span class="nav-text" data-astro-cid-n5etzuft>Anterior</span></button> <div class="slide-dots" data-astro-cid-n5etzuft> <button class="dot active" data-index="0" data-astro-cid-n5etzuft></button><button class="dot " data-index="1" data-astro-cid-n5etzuft></button><button class="dot " data-index="2" data-astro-cid-n5etzuft></button><button class="dot " data-index="3" data-astro-cid-n5etzuft></button><button class="dot " data-index="4" data-astro-cid-n5etzuft></button><button class="dot " data-index="5" data-astro-cid-n5etzuft></button><button class="dot " data-index="6" data-astro-cid-n5etzuft></button><button class="dot " data-index="7" data-astro-cid-n5etzuft></button><button class="dot " data-index="8" data-astro-cid-n5etzuft></button> </div> <button class="nav-btn next-btn" data-astro-cid-n5etzuft><span class="nav-text" data-astro-cid-n5etzuft>Siguiente</span><span class="nav-icon" data-astro-cid-n5etzuft>‚Üí</span></button> </div> <div class="keyboard-hint" data-astro-cid-n5etzuft><kbd data-astro-cid-n5etzuft>‚Üê</kbd> <kbd data-astro-cid-n5etzuft>‚Üí</kbd> para navegar</div> </div> </section> <script>(function(){const slidesJson = "[{\"section\":\"Portada\",\"title\":\"Modelos de Colas M/M/c en la Nube\",\"subtitle\":\"Evaluaci√≥n de Rendimiento y Asignaci√≥n de Recursos\",\"bullets\":[\"Grupo G42 ¬∑ Noviembre 2025\",\"Procesos Estoc√°sticos y Series de Tiempo\",\"Universidad Mayor de San Andr√©s\"],\"image\":\"https://images.unsplash.com/photo-1451187580459-43490279c0fa?w=800&h=500&fit=crop\"},{\"section\":\"Introducci√≥n\",\"title\":\"Contexto del Problema\",\"bullets\":[\"AWS, Azure y Google Cloud: $591 mil millones en 2023\",\"Black Friday: peticiones aumentan exponencialmente\",\"Colas largas ‚Üí tiempos lentos ‚Üí abandono de carritos\",\"M/M/c simula escenarios para optimizar costo vs eficiencia\"],\"image\":\"https://images.unsplash.com/photo-1560732488-6b0df240254a?w=800&h=500&fit=crop\"},{\"section\":\"Problema\",\"title\":\"Pregunta de Investigaci√≥n\",\"highlight\":true,\"bullets\":[\"¬øC√≥mo determinar el n√∫mero √≥ptimo de instancias virtuales?\",\"Minimizar Wq (tiempo en cola) y Lq (longitud de cola)\",\"Controlar costo operativo simult√°neamente\",\"Con llegadas Poisson(Œª) y servicios Exp(Œº)\"],\"image\":\"https://images.unsplash.com/photo-1434494878577-86c23bcb06b9?w=800&h=500&fit=crop\"},{\"section\":\"Marco Te√≥rico\",\"title\":\"Proceso de Poisson y Exponencial\",\"bullets\":[\"N(t) = eventos hasta tiempo t, incremens\",\"Inter-llegada ~ Exp(Œª), tiempo servicio ~ Exp(Œº)\",\"Propiedad sin memoria: P(T > t+s | T > s) = P(T > t)\",\"Base para modelar llegadas HTTP y tiempos de procesamiento\"],\"image\":\"https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=800&h=500&fit=crop\"},{\"section\":\"Marco Te√≥rico\",\"title\":\"Modelo M/M/c ¬∑ F√≥rmulas\",\"highlight\":true,\"isFormula\":true,\"bullets\":[\"œÅ = Œª/(cŒº) < 1 ‚Üí condici√≥n de estabilidad\",\"P‚ÇÄ = [Œ£(r^k/k!) + r^c/(c!(1-œÅ))]‚Åª¬π\",\"Lq = P‚ÇÄ¬∑r^c¬∑œÅ / (c!(1-œÅ)¬≤)\",\"Wq = Lq/Œª ; W = Wq + 1/Œº ; L = ŒªW\"],\"image\":\"https://images.unsplash.com/photo-1509228468518-180dd4864904?w=800&h=500&fit=crop\"},{\"section\":\"Metodolog√≠a\",\"title\":\"Dise√±o del Experimento\",\"bullets\":[\"Python + SimPy para simulaci√≥n discreta de eventos\",\"Streamlit para interfaz web interactiva\",\"Base: Œª=120, Œº=30, c=1..20, tiempo=600s\",\"Sensibilidad: variar Œª, Œº, costos para an√°lisis de trade-offs\"],\"image\":\"https://images.unsplash.com/photo-1555949963-aa79dcee981c?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Resultados de Simulaci√≥n\",\"bullets\":[\"c=4: œÅ=1.00 (inestable), Lq ‚Üí ‚àû\",\"c=6: œÅ=0.67, Lq ‚âà 0.15, Wq ‚âà 0.001s ‚Üí estable\",\"c=8: œÅ=0.50, muy holgado pero costoso\",\"Punto √≥ptimo: c=5-6 donde Wq < 0.01s\"],\"image\":\"https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=500&fit=crop\"},{\"section\":\"Conclusiones\",\"title\":\"Conclusiones\",\"bullets\":[\"M/M/c es robusto para optimizar recursos cloud\",\"Mantener œÅ < 0.8 para resiliencia ante picos\",\"Trade-off costo-rendimiento: diminishing returns con m√°s servidores\",\"Simulaci√≥n valida bien la teor√≠a en sistemas estables\"],\"image\":\"https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?w=800&h=500&fit=crop\"},{\"section\":\"Aplicaciones\",\"title\":\"Aplicaciones Pr√°cticas\",\"bullets\":[\"AWS CloudWatch para autoscaling predictivo\",\"E-commerce: modelar tr√°fico Black Friday\",\"IoT: manejar colas de sensores en tiempo real\",\"Fintech/Healthcare: donde colas impactan tiempos cr√≠ticos\"],\"image\":\"https://images.unsplash.com/photo-1563986768609-322da13575f3?w=800&h=500&fit=crop\"}]";
const id = "informe";

  const slides = JSON.parse(slidesJson);
  let idx = 0;
  
  const container = document.getElementById(id);
  if (container) {
    const slideEl = container.querySelector('.informe-slide');
    const titleEl = container.querySelector('.slide-title');
    const bulletsEl = container.querySelector('.slide-bullets');
    const progressEl = container.querySelector('.slide-progress');
    const sectionEl = container.querySelector('.current-section');
    const sectionLabel = container.querySelector('.slide-section');
    const subtitleEl = container.querySelector('.slide-subtitle');
    const imageContainer = container.querySelector('.slide-image');
    const dotsContainer = container.querySelector('.slide-dots');
    
    function renderSlide() {
      const s = slides[idx];
      if (titleEl) titleEl.textContent = s.title;
      if (bulletsEl) bulletsEl.innerHTML = s.bullets.map(b => "<li>" + b + "</li>").join("");
      if (progressEl) progressEl.textContent = (idx + 1) + " / " + slides.length;
      if (sectionEl) sectionEl.textContent = s.section;
      if (sectionLabel) sectionLabel.textContent = s.section;
      
      if (subtitleEl) {
        if (s.subtitle) { subtitleEl.textContent = s.subtitle; subtitleEl.style.display = "block"; }
        else { subtitleEl.style.display = "none"; }
      }
      
      if (imageContainer) {
        if (s.image) { imageContainer.innerHTML = '<img src="' + s.image + '" alt="" />'; }
      }
      
      if (slideEl) {
        slideEl.classList.toggle("highlight", s.highlight === true);
        slideEl.classList.toggle("code-slide", s.code === true);
        slideEl.classList.toggle("formula-slide", s.isFormula === true);
      }
      
      if (dotsContainer) {
        dotsContainer.querySelectorAll(".dot").forEach((d, i) => {
          d.classList.toggle("active", i === idx);
        });
      }
    }
    
    container.querySelector(".prev-btn")?.addEventListener("click", () => { 
      idx = (idx - 1 + slides.length) % slides.length; 
      renderSlide(); 
    });
    
    container.querySelector(".next-btn")?.addEventListener("click", () => { 
      idx = (idx + 1) % slides.length; 
      renderSlide(); 
    });
    
    dotsContainer?.querySelectorAll(".dot").forEach(d => {
      d.addEventListener("click", (e) => { 
        idx = parseInt(e.target.dataset.index); 
        renderSlide(); 
      });
    });
    
    document.addEventListener("keydown", (e) => {
      const rect = container.getBoundingClientRect();
      const inView = rect.top < window.innerHeight && rect.bottom > 0;
      if (!inView) return;
      if (e.key === "ArrowLeft") { idx = (idx - 1 + slides.length) % slides.length; renderSlide(); }
      if (e.key === "ArrowRight") { idx = (idx + 1) % slides.length; renderSlide(); }
    });
  }
})();</script>  <!-- ANIMACI√ìN VISUAL M/M/c --> <section class="anim-section" id="animacion" data-astro-cid-kvyfnm2w> <div class="section__head" data-astro-cid-kvyfnm2w> <div data-astro-cid-kvyfnm2w> <p class="eyebrow" data-astro-cid-kvyfnm2w>Visualizaci√≥n Interactiva</p> <h2 data-astro-cid-kvyfnm2w>Modelo M/M/c</h2> <p class="section__lede" data-astro-cid-kvyfnm2w>Observa c√≥mo m√∫ltiples servidores atienden clientes en paralelo.</p> </div> </div> <div class="anim-wrapper" data-astro-cid-kvyfnm2w> <div class="anim-params" data-astro-cid-kvyfnm2w> <span id="anim-params-text" data-astro-cid-kvyfnm2w>Œª = 2.00, Œº = 1.00, c = 3, œÅ = 0.67</span> </div> <canvas id="mmc-canvas" width="750" height="380" data-astro-cid-kvyfnm2w></canvas> <div class="anim-controls" data-astro-cid-kvyfnm2w> <div class="slider-group" data-astro-cid-kvyfnm2w> <label data-astro-cid-kvyfnm2w> <span data-astro-cid-kvyfnm2w>Œª (llegadas/s)</span> <input type="range" id="anim-lambda" min="0.5" max="5" step="0.25" value="2" data-astro-cid-kvyfnm2w> <span class="slider-val" id="anim-lambda-val" data-astro-cid-kvyfnm2w>2.00</span> </label> <label data-astro-cid-kvyfnm2w> <span data-astro-cid-kvyfnm2w>Œº (servicio/s)</span> <input type="range" id="anim-mu" min="0.3" max="2" step="0.1" value="1" data-astro-cid-kvyfnm2w> <span class="slider-val" id="anim-mu-val" data-astro-cid-kvyfnm2w>1.00</span> </label> <label data-astro-cid-kvyfnm2w> <span data-astro-cid-kvyfnm2w>c (servidores)</span> <input type="range" id="anim-servers" min="1" max="6" step="1" value="3" data-astro-cid-kvyfnm2w> <span class="slider-val" id="anim-servers-val" data-astro-cid-kvyfnm2w>3</span> </label> </div> <div class="anim-btns" data-astro-cid-kvyfnm2w> <button id="anim-start" class="btn-start" data-astro-cid-kvyfnm2w>‚ñ∂ Iniciar</button> <button id="anim-reset" class="btn-reset" data-astro-cid-kvyfnm2w>‚Ü∫ Reset</button> </div> </div> </div> </section> <!-- SIMULADOR M/M/c --> <section class="sim" id="sim" data-astro-cid-kvyfnm2w> <div class="section__head" data-astro-cid-kvyfnm2w> <div data-astro-cid-kvyfnm2w> <p class="eyebrow" data-astro-cid-kvyfnm2w>Interactivo</p> <h2 data-astro-cid-kvyfnm2w>Simulador M/M/c con JavaScript</h2> <p class="section__lede" data-astro-cid-kvyfnm2w>Ajusta par√°metros, ejecuta la simulaci√≥n real en el navegador y analiza escalabilidad y costo.</p> </div> </div> <div class="sim-grid" data-astro-cid-kvyfnm2w> <div class="controls" data-astro-cid-kvyfnm2w> <label data-astro-cid-kvyfnm2w>Œª (llegadas/s)<input type="range" id="lambda" min="10" max="400" step="10" value="120" data-astro-cid-kvyfnm2w><span class="value" id="lambda-value" data-astro-cid-kvyfnm2w>120</span></label> <label data-astro-cid-kvyfnm2w>Œº (servicio por servidor)<input type="range" id="mu" min="5" max="120" step="5" value="30" data-astro-cid-kvyfnm2w><span class="value" id="mu-value" data-astro-cid-kvyfnm2w>30</span></label> <label data-astro-cid-kvyfnm2w>c (servidores)<input type="range" id="servers" min="1" max="40" step="1" value="6" data-astro-cid-kvyfnm2w><span class="value" id="servers-value" data-astro-cid-kvyfnm2w>6</span></label> <label data-astro-cid-kvyfnm2w>Tiempo de simulaci√≥n (s)<input type="range" id="time" min="100" max="2000" step="50" value="600" data-astro-cid-kvyfnm2w><span class="value" id="time-value" data-astro-cid-kvyfnm2w>600</span></label> <label data-astro-cid-kvyfnm2w>Costo/servidor (USD/mes)<input type="range" id="cost" min="50" max="1500" value="300" data-astro-cid-kvyfnm2w><span class="value" id="cost-value" data-astro-cid-kvyfnm2w>300</span></label> </div> <div class="metrics" data-astro-cid-kvyfnm2w> <div class="metric" data-astro-cid-kvyfnm2w><p data-astro-cid-kvyfnm2w>Utilizaci√≥n œÅ</p><h3 id="rho-out" data-astro-cid-kvyfnm2w>0.00</h3><small id="stable-out" data-astro-cid-kvyfnm2w>‚Äî</small></div> <div class="metric" data-astro-cid-kvyfnm2w><p data-astro-cid-kvyfnm2w>Wq (s) ¬∑ Tiempo en cola</p><h3 id="wq-out" data-astro-cid-kvyfnm2w>0.00</h3></div> <div class="metric" data-astro-cid-kvyfnm2w><p data-astro-cid-kvyfnm2w>Lq ¬∑ Cola promedio</p><h3 id="lq-out" data-astro-cid-kvyfnm2w>0.00</h3></div> <div class="metric" data-astro-cid-kvyfnm2w><p data-astro-cid-kvyfnm2w>Costo mensual (USD)</p><h3 id="cost-out" data-astro-cid-kvyfnm2w>0</h3></div> </div> <div class="actions" data-astro-cid-kvyfnm2w> <button id="run-sim" class="primary" data-astro-cid-kvyfnm2w>Ejecutar simulaci√≥n</button> <button id="analyze" class="ghost" data-astro-cid-kvyfnm2w>Analizar escalabilidad</button> </div> <div class="charts" data-astro-cid-kvyfnm2w><div id="queue-chart" style="width:100%;height:400px;" data-astro-cid-kvyfnm2w></div></div> <div id="analysis-wrapper" class="analysis-wrapper" data-astro-cid-kvyfnm2w> <div id="analysis-loading" class="analysis-loading" data-astro-cid-kvyfnm2w> <div class="loading-ring" data-astro-cid-kvyfnm2w><div data-astro-cid-kvyfnm2w></div><div data-astro-cid-kvyfnm2w></div><div data-astro-cid-kvyfnm2w></div><div data-astro-cid-kvyfnm2w></div></div> <p data-astro-cid-kvyfnm2w>Simulando configuraciones...</p> <div class="loading-progress" data-astro-cid-kvyfnm2w><div id="loading-bar" class="loading-bar" data-astro-cid-kvyfnm2w></div></div> </div> <div id="analysis-content" class="analysis-content" data-astro-cid-kvyfnm2w> <div class="analysis-charts" data-astro-cid-kvyfnm2w> <div class="analysis-chart-box" data-astro-cid-kvyfnm2w><h4 data-astro-cid-kvyfnm2w>Impacto del N√∫mero de Servidores</h4><div id="scalability-chart" data-astro-cid-kvyfnm2w></div></div> <div class="analysis-chart-box" data-astro-cid-kvyfnm2w><h4 data-astro-cid-kvyfnm2w>Trade-off: Costo vs Rendimiento</h4><div id="tradeoff-chart" data-astro-cid-kvyfnm2w></div></div> </div> <div class="analysis-results" data-astro-cid-kvyfnm2w> <h4 data-astro-cid-kvyfnm2w>Resultados Detallados</h4> <div id="analysis-table" class="analysis-table" data-astro-cid-kvyfnm2w></div> <div id="analysis-optimum" class="analysis-optimum" data-astro-cid-kvyfnm2w></div> </div> </div> </div> <div class="formula" data-astro-cid-kvyfnm2w> <p class="eyebrow" data-astro-cid-kvyfnm2w>F√≥rmulas clave</p> <div class="formula-list" data-astro-cid-kvyfnm2w> <div class="formula-item" data-astro-cid-kvyfnm2w><span class="formula-label" data-astro-cid-kvyfnm2w>Utilizaci√≥n:</span><span class="formula-math" id="f1" data-astro-cid-kvyfnm2w></span></div> <div class="formula-item" data-astro-cid-kvyfnm2w><span class="formula-label" data-astro-cid-kvyfnm2w>Probabilidad sistema vac√≠o:</span><span class="formula-math" id="f2" data-astro-cid-kvyfnm2w></span></div> <div class="formula-item" data-astro-cid-kvyfnm2w><span class="formula-label" data-astro-cid-kvyfnm2w>Longitud de cola:</span><span class="formula-math" id="f3" data-astro-cid-kvyfnm2w></span></div> <div class="formula-item" data-astro-cid-kvyfnm2w><span class="formula-label" data-astro-cid-kvyfnm2w>Tiempos y relaciones:</span><span class="formula-math" id="f4" data-astro-cid-kvyfnm2w></span></div> </div> </div> </div> </section> <section class="code-section" id="codigo" data-astro-cid-kkraiuss> <div class="section__head" data-astro-cid-kkraiuss> <div data-astro-cid-kkraiuss> <p class="eyebrow" data-astro-cid-kkraiuss>C√≥digo Fuente</p> <h2 data-astro-cid-kkraiuss>Simulador Python ¬∑ Streamlit + SimPy</h2> <p class="section__lede" data-astro-cid-kkraiuss>El simulador interactivo de arriba es una <strong>r√©plica en JavaScript</strong> del c√≥digo Python original. Aqu√≠ est√° el c√≥digo fuente completo para ejecutar la versi√≥n con Streamlit.</p> </div> </div> <div class="code-notice" data-astro-cid-kkraiuss> <div class="notice-icon" data-astro-cid-kkraiuss>üí°</div> <div class="notice-content" data-astro-cid-kkraiuss><strong>Nota:</strong> El simulador M/M/c que ves arriba en esta p√°gina est√° implementado en JavaScript puro, replicando la l√≥gica del c√≥digo Python. Ambas versiones usan las mismas f√≥rmulas de Erlang-C y simulaci√≥n de eventos discretos.</div> </div> <div class="code-file" data-astro-cid-kkraiuss> <div class="code-header" data-astro-cid-kkraiuss> <span class="code-filename" data-astro-cid-kkraiuss>simulator.py</span> <span class="code-desc" data-astro-cid-kkraiuss>Motor de simulaci√≥n M/M/c con SimPy</span> </div> <pre class="code-block" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss># simulator.py
import simpy
import random
import numpy as np
import math

def run_simulation(lambda_rate, mu_rate, num_servers, sim_time=600, seed=42):
    random.seed(seed)
    np.random.seed(seed)
    
    arrivals, queue_lengths, wait_times = [], [], []

    def arrival(env, servers):
        while True:
            yield env.timeout(random.expovariate(lambda_rate))
            arrivals.append(env.now)
            env.process(customer(env, servers))
    
    def customer(env, servers):
        arrive = env.now
        with servers.request() as req:
            queue_lengths.append(len(servers.queue))
            yield req
            wait_times.append(env.now - arrive)
            yield env.timeout(random.expovariate(mu_rate))
    
    env = simpy.Environment()
    servers = simpy.Resource(env, capacity=num_servers)
    env.process(arrival(env, servers))
    env.run(until=sim_time)

    # === C√ÅLCULO TE√ìRICO (Erlang-C) ===
    rho = lambda_rate / (num_servers * mu_rate)
    if rho < 1:
        r = lambda_rate / mu_rate
        sum_term = sum(r**k / math.factorial(k) for k in range(num_servers))
        P0 = 1 / (sum_term + r**num_servers / (math.factorial(num_servers) * (1-rho)))
        Lq = P0 * (r**num_servers) * rho / (math.factorial(num_servers) * (1-rho)**2)
        Wq = Lq / lambda_rate
    else:
        Lq = Wq = float('inf')

    return dict(rho=rho, Lq_theory=Lq, Wq_theory=Wq,
                Lq_sim=np.mean(queue_lengths), Wq_sim=np.mean(wait_times))</code></pre> </div><div class="code-file" data-astro-cid-kkraiuss> <div class="code-header" data-astro-cid-kkraiuss> <span class="code-filename" data-astro-cid-kkraiuss>app.py</span> <span class="code-desc" data-astro-cid-kkraiuss>Interfaz web con Streamlit y Plotly</span> </div> <pre class="code-block" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss># app.py - Cloud Queue Simulator M/M/c
import streamlit as st
import numpy as np
import pandas as pd
import plotly.express as px
from simulator import run_simulation

st.set_page_config(page_title="Cloud Queue Simulator", layout="wide")

with st.sidebar:
    lambda_rate = st.slider("Tasa de llegada", 10, 400, 120)
    mu_rate = st.slider("Tasa de servicio", 10, 100, 30)
    num_servers = st.slider("Servidores (c)", 1, 40, 6)
    sim_time = st.slider("Duracion (s)", 120, 1800, 600)
    costo = st.number_input("Costo/servidor ($)", 10, 2000, 120)

results = run_simulation(lambda_rate, mu_rate, num_servers, sim_time)

# Metricas
c1, c2, c3, c4 = st.columns(4)
c1.metric("Utilizacion", f"{results['rho']:.1%}")
c2.metric("Tiempo en cola", f"{results['Wq_sim']:.3f} s")
c3.metric("Cola promedio", f"{results['Lq_sim']:.1f}")
c4.metric("Costo mensual", f"${num_servers * costo}")

# Grafico de cola
df = pd.DataFrame({
    'Tiempo': np.linspace(0, sim_time, 100),
    'Cola': results.get('queue_lengths', [])
})
fig = px.area(df, x='Tiempo', y='Cola', template="plotly_dark")
st.plotly_chart(fig, use_container_width=True)</code></pre> </div> <div class="code-run" data-astro-cid-kkraiuss> <div class="run-header" data-astro-cid-kkraiuss> <span class="run-icon" data-astro-cid-kkraiuss>‚ñ∂</span> <span data-astro-cid-kkraiuss>Ejecutar</span> </div> <pre class="run-commands" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss># Instalar dependencias
pip install streamlit simpy numpy pandas plotly

# Ejecutar la app
cd &quot;proy 13 (python)&quot;
streamlit run app.py</code></pre> </div> </section>  </main> <footer class="footer" data-astro-cid-sz7xmlte> <span data-astro-cid-sz7xmlte>Universidad Mayor de San Andr√©s ¬∑ 2025</span> <span data-astro-cid-sz7xmlte>Proyecto 13 ¬∑ Modelos de colas M/M/c</span> </footer>   </div> <div id="tsparticles" style="--accentColor: #8ad6ff;--accentColor2: #72f0d5;"></div>  <script>
    window.addEventListener("load", () => {
      if (window.tsParticles) {
        const accent = getComputedStyle(document.body).getPropertyValue('--accent').trim() || '#10b981';
        const accent2 = getComputedStyle(document.body).getPropertyValue('--accent-2').trim() || '#3b82f6';
        
        window.tsParticles.load("tsparticles", {
          fpsLimit: 60, fullScreen: { enable: false },
          particles: {
            number: { value: 60, density: { enable: true, area: 900 } },
            color: { value: [accent, accent2, "#8b5cf6"] },
            links: { enable: true, distance: 140, color: accent, opacity: 0.25, width: 1 },
            move: { enable: true, speed: 1.2, outModes: "out" },
            opacity: { value: { min: 0.2, max: 0.5 } },
            size: { value: { min: 1.5, max: 3 } }
          },
          interactivity: { events: { onHover: { enable: true, mode: "grab" } } },
          detectRetina: true
        });
      }
    });
  </script>  </body></html> <script>
// Animaci√≥n M/M/c estilo Manim
(function() {
  const canvas = document.getElementById('mmc-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  
  let lambda = 2, mu = 1, numServers = 3;
  let running = false;
  let balls = [];
  let servers = []; // { busy: false, ball: null }
  let served = 0;
  let nextArrival = 0;
  let simTime = 0;
  
  // Layout base
  const L = {
    queueX: 140,
    queueTopY: 80,
    queueSpacing: 40,
    serversStartX: 380,
    serversSpacingY: 85,
    serverW: 80,
    serverH: 65,
    exitX: 700,
    ballR: 15,
    arriveFromX: -40,
    arriveY: 80
  };
  
  function resizeCanvas() {
    // Calcular altura necesaria seg√∫n n√∫mero de servidores
    const minHeight = 350;
    const heightPerServer = L.serversSpacingY;
    const padding = 120;
    const neededHeight = Math.max(minHeight, numServers * heightPerServer + padding);
    canvas.height = neededHeight;
  }
  
  const colors = {
    bg: '#0d1117',
    grid: 'rgba(255,255,255,0.03)',
    text: '#8b949e',
    textBright: '#c9d1d9',
    ball: '#8ad6ff',
    serving: '#72f0d5',
    server: '#58a6ff',
    serverFill: 'rgba(88,166,255,0.1)',
    serverBusy: '#f0883e',
    exit: '#a371f7'
  };
  
    function randExp(rate) {
      return -Math.log(1 - Math.random()) / rate;
    }
  
  function lerp(a, b, t) {
    return a + (b - a) * Math.min(1, t);
  }
  
  function initServers() {
    servers = [];
    for (let i = 0; i < numServers; i++) {
      servers.push({ busy: false, ball: null });
    }
    resizeCanvas();
  }
  
  function getServerY(index) {
    const totalHeight = (numServers - 1) * L.serversSpacingY;
    const startY = (canvas.height - totalHeight) / 2;
    return startY + index * L.serversSpacingY;
  }
  
  function drawScene() {
    ctx.fillStyle = colors.bg;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Grid sutil
    ctx.strokeStyle = colors.grid;
    ctx.lineWidth = 1;
    for (let x = 0; x < canvas.width; x += 40) {
      ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke();
    }
    for (let y = 0; y < canvas.height; y += 40) {
      ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();
    }
    
    // L√≠nea de cola (vertical)
    ctx.strokeStyle = 'rgba(138,214,255,0.3)';
    ctx.lineWidth = 2;
    ctx.setLineDash([6, 4]);
    ctx.beginPath();
    ctx.moveTo(L.queueX, L.queueTopY - 20);
    ctx.lineTo(L.queueX, L.queueTopY + 9 * L.queueSpacing);
    ctx.stroke();
    ctx.setLineDash([]);
    
    // Etiqueta cola
    ctx.fillStyle = colors.text;
    ctx.font = '11px Manrope, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('COLA', L.queueX, L.queueTopY - 35);
    
    // Dibujar servidores
    for (let i = 0; i < numServers; i++) {
      const y = getServerY(i);
      const isBusy = servers[i] && servers[i].busy;
      
      // L√≠nea de conexi√≥n cola -> servidor
      ctx.strokeStyle = 'rgba(138,214,255,0.15)';
      ctx.lineWidth = 1;
      ctx.setLineDash([4, 4]);
      ctx.beginPath();
      ctx.moveTo(L.queueX + 30, L.queueTopY);
      ctx.lineTo(L.serversStartX - L.serverW/2, y);
      ctx.stroke();
      ctx.setLineDash([]);
      
      // Servidor
      ctx.strokeStyle = isBusy ? colors.serverBusy : colors.server;
      ctx.lineWidth = 2;
      ctx.strokeRect(L.serversStartX - L.serverW/2, y - L.serverH/2, L.serverW, L.serverH);
      ctx.fillStyle = isBusy ? 'rgba(240,136,62,0.1)' : colors.serverFill;
      ctx.fillRect(L.serversStartX - L.serverW/2, y - L.serverH/2, L.serverW, L.serverH);
      
      // Etiqueta servidor
      ctx.fillStyle = colors.text;
      ctx.font = '10px Manrope, system-ui, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(`S${i + 1}`, L.serversStartX, y + L.serverH/2 + 15);
      
      // Estado
      ctx.font = 'bold 9px Manrope, system-ui, sans-serif';
      ctx.fillStyle = isBusy ? colors.serverBusy : colors.server;
      ctx.fillText(isBusy ? 'OCUPADO' : 'LIBRE', L.serversStartX, y - L.serverH/2 - 8);
    }
    
    // Contador atendidos
    ctx.font = '12px Manrope, system-ui, sans-serif';
    ctx.fillStyle = colors.textBright;
    ctx.textAlign = 'right';
    ctx.fillText(`Atendidos: ${served}`, canvas.width - 15, canvas.height - 15);
    
    // Cantidad en cola
    const inQueue = balls.filter(b => b.state === 'queue').length;
    ctx.textAlign = 'left';
    ctx.fillText(`En cola: ${inQueue}`, 15, canvas.height - 15);
    
    // Servidores ocupados
    const busyCount = servers.filter(s => s.busy).length;
    ctx.textAlign = 'center';
    ctx.fillText(`Servidores ocupados: ${busyCount}/${numServers}`, canvas.width / 2, canvas.height - 15);
  }
  
  function drawBall(b) {
    ctx.beginPath();
    ctx.arc(b.x, b.y, L.ballR, 0, Math.PI * 2);
    
    let color = colors.ball;
    if (b.state === 'serving') color = colors.serving;
    if (b.state === 'exiting') color = colors.exit;
    
    ctx.fillStyle = color;
    ctx.fill();
    ctx.strokeStyle = 'rgba(255,255,255,0.3)';
    ctx.lineWidth = 2;
    ctx.stroke();
    
    // Progreso de servicio
    if (b.state === 'serving' && b.serviceProgress > 0) {
      ctx.beginPath();
      ctx.arc(b.x, b.y, L.ballR + 4, -Math.PI/2, -Math.PI/2 + b.serviceProgress * Math.PI * 2);
      ctx.strokeStyle = colors.server;
      ctx.lineWidth = 3;
      ctx.stroke();
    }
  }
  
  function updateBalls(dt) {
    balls.forEach(b => {
      if (b.state === 'arriving') {
        b.x = lerp(b.x, b.targetX, dt * 5);
        b.y = lerp(b.y, b.targetY, dt * 5);
        if (Math.abs(b.x - b.targetX) < 2 && Math.abs(b.y - b.targetY) < 2) {
          b.x = b.targetX;
          b.y = b.targetY;
          b.state = 'queue';
        }
      }
      
      if (b.state === 'queue') {
        b.targetY = L.queueTopY + b.queueIndex * L.queueSpacing;
        b.y = lerp(b.y, b.targetY, dt * 8);
      }
      
      if (b.state === 'toServer') {
        const serverY = getServerY(b.serverIndex);
        b.x = lerp(b.x, L.serversStartX, dt * 5);
        b.y = lerp(b.y, serverY, dt * 5);
        if (Math.abs(b.x - L.serversStartX) < 3 && Math.abs(b.y - serverY) < 3) {
          b.x = L.serversStartX;
          b.y = serverY;
          b.state = 'serving';
          b.serviceProgress = 0;
          b.serviceDuration = randExp(mu);
          servers[b.serverIndex].busy = true;
          servers[b.serverIndex].ball = b;
        }
      }
      
      if (b.state === 'serving') {
        b.serviceProgress += dt / b.serviceDuration;
        if (b.serviceProgress >= 1) {
          b.state = 'exiting';
          b.serviceProgress = 1;
          servers[b.serverIndex].busy = false;
          servers[b.serverIndex].ball = null;
          served++;
        }
      }
      
      if (b.state === 'exiting') {
        b.x = lerp(b.x, L.exitX + 100, dt * 4);
      }
    });
    
    // Remover bolitas que salieron
    balls = balls.filter(b => b.state !== 'exiting' || b.x < canvas.width + 50);
    
    // Recalcular √≠ndices de cola
    let idx = 0;
    balls.filter(b => b.state === 'queue').forEach(b => {
      b.queueIndex = idx++;
    });
    
    // Mover bolitas de la cola a servidores libres
    const firstInQueue = balls.find(b => b.state === 'queue' && b.queueIndex === 0);
    if (firstInQueue) {
      // Buscar servidor libre que no tenga a nadie yendo
      const someoneGoingToServer = (idx) => balls.some(b => b.state === 'toServer' && b.serverIndex === idx);
      
      for (let i = 0; i < servers.length; i++) {
        if (!servers[i].busy && !someoneGoingToServer(i)) {
          firstInQueue.state = 'toServer';
          firstInQueue.serverIndex = i;
          break;
        }
      }
    }
  }
  
  function spawnBall() {
    // Buscar servidor libre
    const freeServerIndex = servers.findIndex(s => !s.busy);
    const someoneGoingToThatServer = (idx) => balls.some(b => b.state === 'toServer' && b.serverIndex === idx);
    
    // Encontrar un servidor que est√© libre Y que nadie est√© yendo a √©l
    let targetServer = -1;
    for (let i = 0; i < servers.length; i++) {
      if (!servers[i].busy && !someoneGoingToThatServer(i)) {
        targetServer = i;
        break;
      }
    }
    
    if (targetServer !== -1) {
      // Ir directo al servidor
      balls.push({
        state: 'toServer',
        x: L.arriveFromX,
        y: L.arriveY,
        targetX: L.serversStartX,
        targetY: getServerY(targetServer),
        queueIndex: -1,
        serverIndex: targetServer,
        serviceProgress: 0,
        serviceDuration: 0
      });
    } else {
      // Todos ocupados, ir a la cola
      const queueCount = balls.filter(b => b.state === 'queue' || b.state === 'arriving').length;
      balls.push({
        state: 'arriving',
        x: L.arriveFromX,
        y: L.arriveY,
        targetX: L.queueX,
        targetY: L.queueTopY + queueCount * L.queueSpacing,
        queueIndex: queueCount,
        serverIndex: -1,
        serviceProgress: 0,
        serviceDuration: 0
      });
    }
  }
  
  let lastTime = 0;
  function loop(timestamp) {
    if (!running) return;
    
    const dt = lastTime ? (timestamp - lastTime) / 1000 : 0.016;
    lastTime = timestamp;
    
    simTime += dt;
    
    // Llegadas
    if (simTime >= nextArrival) {
      spawnBall();
      nextArrival = simTime + randExp(lambda);
    }
    
    updateBalls(dt);
    drawScene();
    balls.forEach(drawBall);
    
    requestAnimationFrame(loop);
  }
  
  function reset() {
    balls = [];
    served = 0;
    simTime = 0;
    nextArrival = randExp(lambda);
    lastTime = 0;
    initServers();
    drawScene();
  }
  
  function updateParamsText() {
    const rho = (lambda / (numServers * mu)).toFixed(2);
    document.getElementById('anim-params-text').textContent = 
      `Œª = ${lambda.toFixed(2)}, Œº = ${mu.toFixed(2)}, c = ${numServers}, œÅ = ${rho}`;
  }
  
  // Event listeners
  document.getElementById('anim-lambda').addEventListener('input', function(e) {
    lambda = parseFloat(e.target.value);
    document.getElementById('anim-lambda-val').textContent = lambda.toFixed(2);
    updateParamsText();
  });
  
  document.getElementById('anim-mu').addEventListener('input', function(e) {
    mu = parseFloat(e.target.value);
    document.getElementById('anim-mu-val').textContent = mu.toFixed(2);
    updateParamsText();
  });
  
  document.getElementById('anim-servers').addEventListener('input', function(e) {
    numServers = parseInt(e.target.value);
    document.getElementById('anim-servers-val').textContent = numServers;
    initServers();
    updateParamsText();
    if (!running) {
      reset();
    }
  });
  
  document.getElementById('anim-start').addEventListener('click', function() {
    running = !running;
    this.textContent = running ? '‚è∏ Pausar' : '‚ñ∂ Iniciar';
    this.classList.toggle('active', running);
    if (running) {
      lastTime = 0;
      requestAnimationFrame(loop);
    }
  });
  
  document.getElementById('anim-reset').addEventListener('click', function() {
    running = false;
    document.getElementById('anim-start').textContent = '‚ñ∂ Iniciar';
    document.getElementById('anim-start').classList.remove('active');
    reset();
  });
  
  // Init
  initServers();
  reset();
  updateParamsText();
})();
</script> <script>
    // === Simulador M/M/c en JavaScript ===
  function factorial(n) { let r = 1; for (let i = 2; i <= n; i++) r *= i; return r; }
  function randExp(rate) { return -Math.log(1 - Math.random()) / rate; }

    function simulate(lambda, mu, c, simTime) {
    let t = 0, nextArrival = randExp(lambda), serviceEndTimes = [], queue = [], waitTimes = [], timeline = [[0, 0]];
      while (true) {
        const nextService = serviceEndTimes.length > 0 ? serviceEndTimes[0] : Infinity;
        if (nextArrival <= nextService && nextArrival <= simTime) {
          t = nextArrival;
        if (serviceEndTimes.length < c) { serviceEndTimes.push(t + randExp(mu)); serviceEndTimes.sort((a, b) => a - b); waitTimes.push(0); }
        else { queue.push(t); }
          nextArrival += randExp(lambda);
          timeline.push([t, queue.length]);
      } else if (nextService < nextArrival && nextService <= simTime) {
        t = nextService; serviceEndTimes.shift();
        if (queue.length > 0) { waitTimes.push(t - queue.shift()); serviceEndTimes.push(t + randExp(mu)); serviceEndTimes.sort((a, b) => a - b); }
          timeline.push([t, queue.length]);
      } else { break; }
        if (t > simTime) break;
      }
    if (timeline[timeline.length - 1][0] < simTime) timeline.push([simTime, timeline[timeline.length - 1][1]]);
    
    let area = 0; for (let i = 0; i < timeline.length - 1; i++) area += timeline[i][1] * (timeline[i + 1][0] - timeline[i][0]);
    const rho = lambda / (c * mu), stable = rho < 1, r = lambda / mu;
    let Lq_theory = NaN, Wq_theory = NaN;
      if (stable && lambda > 0 && mu > 0) {
      let sumTerm = 0; for (let k = 0; k < c; k++) sumTerm += Math.pow(r, k) / factorial(k);
      const P0 = 1 / (sumTerm + Math.pow(r, c) / (factorial(c) * (1 - rho)));
        Lq_theory = P0 * Math.pow(r, c) * rho / (factorial(c) * Math.pow(1 - rho, 2));
        Wq_theory = Lq_theory / lambda;
    }
    return { timeline, waitTimes, Lq_sim: area / simTime, Wq_sim: waitTimes.length > 0 ? waitTimes.reduce((a, b) => a + b, 0) / waitTimes.length : 0, rho, stable, Lq_theory, Wq_theory };
  }

    function bindSliders() {
    ["lambda", "mu", "servers", "time", "cost"].forEach(id => {
      const input = document.getElementById(id), valueEl = document.getElementById(`${id}-value`);
      input.addEventListener("input", () => valueEl.textContent = input.value);
    });
  }

    async function runSimulation() {
    const lambda = +document.getElementById("lambda").value, mu = +document.getElementById("mu").value;
    const servers = +document.getElementById("servers").value, simTime = +document.getElementById("time").value, cost = +document.getElementById("cost").value;
      const res = simulate(lambda, mu, servers, simTime);
    
      document.getElementById("rho-out").textContent = res.rho.toFixed(3);
    document.getElementById("stable-out").textContent = res.stable ? "Estable (œÅ < 1)" : "Inestable";
      document.getElementById("wq-out").textContent = res.Wq_sim.toFixed(3);
      document.getElementById("lq-out").textContent = res.Lq_sim.toFixed(3);
    document.getElementById("cost-out").textContent = "$" + (servers * cost).toLocaleString();

    Plotly.newPlot("queue-chart", [{ x: res.timeline.map(p => p[0]), y: res.timeline.map(p => p[1]), type: "scatter", mode: "lines", fill: "tozeroy", name: "Cola", line: { color: "#8ad6ff" } }], {
      title: `Evoluci√≥n de la cola ‚Äì M/M/${servers}`, xaxis: { title: "Tiempo (s)" }, yaxis: { title: "Longitud de cola" },
      paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.1)', font: { color: '#94a3b8' }, margin: { t: 40, l: 50, r: 10, b: 40 }
    }, { responsive: true });
  }

    async function analyze() {
    const wrapper = document.getElementById("analysis-wrapper"), loading = document.getElementById("analysis-loading"), content = document.getElementById("analysis-content"), loadingBar = document.getElementById("loading-bar");
    wrapper.classList.add("visible"); loading.classList.add("active"); content.classList.remove("visible"); loadingBar.style.width = "0%";
    wrapper.scrollIntoView({ behavior: "smooth", block: "start" });
    await new Promise(r => setTimeout(r, 100));
    
    const lambda = +document.getElementById("lambda").value, mu = +document.getElementById("mu").value, serversCurrent = +document.getElementById("servers").value, costPerServer = +document.getElementById("cost").value;
    const simTime = Math.min(+document.getElementById("time").value, 400);
    const minServers = Math.max(1, Math.floor(lambda / mu) - 2), maxServers = serversCurrent + 15, results = [];
    
      for (let c = minServers; c <= maxServers; c++) {
        const res = simulate(lambda, mu, c, simTime);
      results.push({ servers: c, Wq: res.Wq_sim, Lq: res.Lq_sim, rho: res.rho, cost: c * costPerServer });
      loadingBar.style.width = ((c - minServers + 1) / (maxServers - minServers + 1)) * 100 + "%";
      await new Promise(r => setTimeout(r, 30));
    }
    
    loading.classList.remove("active"); content.classList.add("visible");
    
    Plotly.newPlot("scalability-chart", [
      { x: results.map(d => d.servers), y: results.map(d => d.Wq), type: "scatter", mode: "lines+markers", name: "Tiempo en cola (s)", line: { width: 3, color: "#8ad6ff" } },
      { x: results.map(d => d.servers), y: results.map(d => d.cost), type: "scatter", mode: "lines+markers", name: "Costo ($)", yaxis: "y2", line: { width: 3, color: "#72f0d5" } }
    ], { xaxis: { title: "Servidores (c)" }, yaxis: { title: "Tiempo en cola (s)" }, yaxis2: { title: "Costo ($)", overlaying: "y", side: "right" }, paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.1)', font: { color: '#94a3b8' }, margin: { t: 20, l: 50, r: 50, b: 50 }, legend: { x: 0.5, y: 1.1, orientation: "h" } }, { responsive: true });
    
    Plotly.newPlot("tradeoff-chart", [{ x: results.map(d => d.cost), y: results.map(d => d.Wq), type: "scatter", mode: "lines+markers", name: "Frontera", line: { width: 4, color: "#8ad6ff" } }], { xaxis: { title: "Costo ($)" }, yaxis: { title: "Tiempo en cola (s)" }, paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.1)', font: { color: '#94a3b8' }, margin: { t: 20, l: 50, r: 10, b: 50 } }, { responsive: true });
    
    document.getElementById("analysis-table").innerHTML = "<table><thead><tr><th>Servidores</th><th>Wq (s)</th><th>Lq</th><th>œÅ</th><th>Costo</th></tr></thead><tbody>" + results.map(r => `<tr><td>${r.servers}</td><td>${r.Wq.toFixed(3)}</td><td>${r.Lq.toFixed(3)}</td><td>${r.rho.toFixed(3)}</td><td>$${r.cost.toLocaleString()}</td></tr>`).join("") + "</tbody></table>";
    
    const candidates = results.filter(r => r.Wq < 0.5), optimum = candidates.length > 0 ? candidates.reduce((min, cur) => cur.cost < min.cost ? cur : min) : null;
    document.getElementById("analysis-optimum").innerHTML = optimum ? `Punto √≥ptimo: <strong>${optimum.servers} servidores</strong> ‚Üí Wq ‚âà ${optimum.Wq.toFixed(3)}s ‚Üí $${optimum.cost.toLocaleString()}` : "No se encontr√≥ configuraci√≥n con Wq < 0.5s";
  }

  window.addEventListener("load", () => {
      bindSliders();
      document.getElementById("run-sim").addEventListener("click", runSimulation);
      document.getElementById("analyze").addEventListener("click", analyze);
      runSimulation();
    
    // KaTeX
    function tryKaTeX() {
      if (typeof katex === "undefined") { setTimeout(tryKaTeX, 100); return; }
      var formulas = { 'f1': '\\rho = \\dfrac{\\lambda}{c \\cdot \\mu} < 1', 'f2': 'P_0 = \\left[ \\sum_{k=0}^{c-1} \\dfrac{r^k}{k!} + \\dfrac{r^c}{c!(1-\\rho)} \\right]^{-1}', 'f3': 'L_q = \\dfrac{P_0 \\cdot r^c \\cdot \\rho}{c! \\cdot (1-\\rho)^2}', 'f4': 'W_q = \\dfrac{L_q}{\\lambda}, W = W_q + \\dfrac{1}{\\mu}, L = \\lambda W' };
      Object.keys(formulas).forEach(id => { var el = document.getElementById(id); if (el) katex.render(formulas[id], el, { displayMode: false, throwOnError: false }); });
    }
    tryKaTeX();
  });
  </script> 