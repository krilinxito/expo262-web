<!DOCTYPE html><html lang="es" style="--accentColor: #22d3ee;--accentColor2: #a78bfa;"> <head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Proyecto 25 · Mutaciones TP53 con Procesos de Poisson</title><meta name="description" content="Análisis de mutaciones del gen TP53 usando Procesos de Poisson homogéneos y no homogéneos."><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Manrope:wght@400;600&display=swap" rel="stylesheet"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" crossorigin="anonymous"></script><script src="https://cdn.plot.ly/plotly-2.27.0.min.js" charset="utf-8"></script><link rel="stylesheet" href="/_astro/13.CrL8Mm4X.css">
<link rel="stylesheet" href="/_astro/25.B7dGIaNX.css"><script type="module" src="/_astro/hoisted.QOdwnJaL.js"></script></head> <body style="--accent: #22d3ee; --accent-2: #a78bfa;; --accentColor: #22d3ee;--accentColor2: #a78bfa;"> <div class="page" style="--accentColor: #22d3ee;--accentColor2: #a78bfa;">  <header class="topbar" data-astro-cid-axxsutmj> <div class="brand" data-astro-cid-axxsutmj> <div class="dot" data-astro-cid-axxsutmj></div> <span data-astro-cid-axxsutmj>Proyecto 25 · TP53 Mutations</span> </div> <nav data-astro-cid-axxsutmj> <a href="/" data-astro-cid-axxsutmj>Home</a><a href="#informe" data-astro-cid-axxsutmj>Informe</a><a href="#animacion" data-astro-cid-axxsutmj>Animación</a><a href="#simulador" data-astro-cid-axxsutmj>Simulador</a><a href="#compuesto" data-astro-cid-axxsutmj>Compuesto</a><a href="#graficos" data-astro-cid-axxsutmj>Gráficos</a> </nav> </header>  <main data-astro-cid-oimuypky> <!-- HERO PERSONALIZADO --> <section class="hero" data-astro-cid-oimuypky> <div class="hero__copy" data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Tema 25</p> <h1 data-astro-cid-oimuypky>Procesos de Poisson en Mutaciones del Gen TP53</h1> <p class="lede" data-astro-cid-oimuypky>Análisis estadístico del gen supresor de tumores más importante. Modelado con procesos de Poisson <strong data-astro-cid-oimuypky>homogéneos</strong> y <strong data-astro-cid-oimuypky>no homogéneos</strong> para identificar hotspots mutacionales y tendencias temporales.</p> <div class="tags" data-astro-cid-oimuypky> <span data-astro-cid-oimuypky>Gen TP53 · p53</span> <span data-astro-cid-oimuypky>Poisson Homogéneo</span> <span data-astro-cid-oimuypky>Poisson No Homogéneo</span> <span data-astro-cid-oimuypky>Bioinformática</span> </div> <div class="cta" data-astro-cid-oimuypky> <a class="primary" href="#simulador" data-astro-cid-oimuypky>Simulador Interactivo</a> <a class="ghost" href="#graficos" data-astro-cid-oimuypky>Ver Gráficos</a> </div> </div> <div class="hero__panel" data-astro-cid-oimuypky> <div class="panel__header" data-astro-cid-oimuypky><span class="chip" data-astro-cid-oimuypky>Dataset Real</span><span class="status" data-astro-cid-oimuypky>TP53 UMD</span></div> <div class="panel__list" data-astro-cid-oimuypky> <div class="panel__item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Variantes únicas</span><p data-astro-cid-oimuypky>33,603 mutaciones</p></div> <div class="panel__item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Total de eventos</span><p data-astro-cid-oimuypky>37,018,402 ocurrencias</p></div> <div class="panel__item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Tasa λ global</span><p data-astro-cid-oimuypky>1,101.64 /variante</p></div> <div class="panel__item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Índice Dispersión</span><p class="warning" data-astro-cid-oimuypky>1,082.6 (sobredispersión)</p></div> </div> <div class="panel__footer" data-astro-cid-oimuypky><span class="bubble ghost" data-astro-cid-oimuypky>1989-2016</span><span class="bubble" data-astro-cid-oimuypky>CpG 6.44× más</span></div> </div> </section> <section class="informe-carousel" id="informe" data-astro-cid-n5etzuft> <div class="section__head" data-astro-cid-n5etzuft> <div data-astro-cid-n5etzuft> <p class="eyebrow" data-astro-cid-n5etzuft>Informe</p> <h2 data-astro-cid-n5etzuft>Presentación del Proyecto</h2> <p class="section__lede" data-astro-cid-n5etzuft>Navegá a través de las slides del análisis completo.</p> </div> <div class="slide-nav-info" data-astro-cid-n5etzuft> <span class="slide-progress" data-astro-cid-n5etzuft>1 / 14</span> <span class="current-section" data-astro-cid-n5etzuft>Portada</span> </div> </div> <div class="informe-slider" data-astro-cid-n5etzuft> <div class="informe-slide" data-astro-cid-n5etzuft> <div class="slide-content" data-astro-cid-n5etzuft> <div class="slide-text" data-astro-cid-n5etzuft> <p class="slide-section" data-astro-cid-n5etzuft>Portada</p> <h3 class="slide-title" data-astro-cid-n5etzuft>Procesos de Poisson en Mutaciones del Gen TP53</h3> <p class="slide-subtitle" data-astro-cid-n5etzuft>Análisis Estadístico de Variantes Genéticas</p> <ul class="slide-bullets" data-astro-cid-n5etzuft> <li data-astro-cid-n5etzuft>Grupo G42 · Noviembre 2025</li><li data-astro-cid-n5etzuft>Procesos Estocásticos y Series de Tiempo</li><li data-astro-cid-n5etzuft>Universidad Mayor de San Andrés</li> </ul> </div> <div class="slide-image" data-astro-cid-n5etzuft> <img src="https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=800&h=500&fit=crop" alt="" data-astro-cid-n5etzuft> </div> </div> </div> <div class="informe-controls" data-astro-cid-n5etzuft> <button class="nav-btn prev-btn" data-astro-cid-n5etzuft><span class="nav-icon" data-astro-cid-n5etzuft>←</span><span class="nav-text" data-astro-cid-n5etzuft>Anterior</span></button> <div class="slide-dots" data-astro-cid-n5etzuft> <button class="dot active" data-index="0" data-astro-cid-n5etzuft></button><button class="dot " data-index="1" data-astro-cid-n5etzuft></button><button class="dot " data-index="2" data-astro-cid-n5etzuft></button><button class="dot " data-index="3" data-astro-cid-n5etzuft></button><button class="dot " data-index="4" data-astro-cid-n5etzuft></button><button class="dot " data-index="5" data-astro-cid-n5etzuft></button><button class="dot " data-index="6" data-astro-cid-n5etzuft></button><button class="dot " data-index="7" data-astro-cid-n5etzuft></button><button class="dot " data-index="8" data-astro-cid-n5etzuft></button><button class="dot " data-index="9" data-astro-cid-n5etzuft></button><button class="dot " data-index="10" data-astro-cid-n5etzuft></button><button class="dot " data-index="11" data-astro-cid-n5etzuft></button><button class="dot " data-index="12" data-astro-cid-n5etzuft></button><button class="dot " data-index="13" data-astro-cid-n5etzuft></button> </div> <button class="nav-btn next-btn" data-astro-cid-n5etzuft><span class="nav-text" data-astro-cid-n5etzuft>Siguiente</span><span class="nav-icon" data-astro-cid-n5etzuft>→</span></button> </div> <div class="keyboard-hint" data-astro-cid-n5etzuft><kbd data-astro-cid-n5etzuft>←</kbd> <kbd data-astro-cid-n5etzuft>→</kbd> para navegar</div> </div> </section> <script>(function(){const slidesJson = "[{\"section\":\"Portada\",\"title\":\"Procesos de Poisson en Mutaciones del Gen TP53\",\"subtitle\":\"Análisis Estadístico de Variantes Genéticas\",\"bullets\":[\"Grupo G42 · Noviembre 2025\",\"Procesos Estocásticos y Series de Tiempo\",\"Universidad Mayor de San Andrés\"],\"image\":\"https://images.unsplash.com/photo-1507413245164-6160d8298b31?w=800&h=500&fit=crop\"},{\"section\":\"Introducción\",\"title\":\"El Gen TP53: Guardián del Genoma\",\"bullets\":[\"TP53 codifica la proteína p53, supresora de tumores más estudiada\",\"Mutado en >50% de todos los cánceres humanos\",\"Regula ciclo celular, apoptosis y reparación del ADN\",\"Base de datos UMD: 33,603 variantes únicas (1989-2016)\"],\"image\":\"https://images.unsplash.com/photo-1628595351029-c2bf17511435?w=800&h=500&fit=crop\"},{\"section\":\"Problema\",\"title\":\"Planteamiento del Problema\",\"highlight\":true,\"bullets\":[\"Las mutaciones NO se distribuyen uniformemente en el gen\",\"Algunos codones acumulan miles de veces más mutaciones\",\"Factores biológicos (sitios CpG) alteran las tasas locales\",\"Se requiere un modelo que capture esta heterogeneidad\"],\"image\":\"https://images.unsplash.com/photo-1532187863486-abf9dbad1b69?w=800&h=500&fit=crop\"},{\"section\":\"Marco Teórico\",\"title\":\"Proceso de Poisson Homogéneo\",\"bullets\":[\"N(t) cuenta eventos en [0,t] con tasa CONSTANTE λ\",\"P(N(t)=k) = (λt)^k · e^(-λt) / k!\",\"E[N(t)] = Var[N(t)] = λt (equidispersión)\",\"Tiempos entre eventos ~ Exponencial(λ)\"],\"image\":\"https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=800&h=500&fit=crop\"},{\"section\":\"Marco Teórico\",\"title\":\"Proceso de Poisson No Homogéneo\",\"bullets\":[\"Tasa λ(t) VARIABLE en el tiempo: λ(t) = a + b·t\",\"Intensidad acumulada: Λ(t) = ∫₀ᵗ λ(s)ds\",\"Captura tendencias temporales en la tasa de mutación\",\"Permite modelar cambios en patrones de reporte\"],\"image\":\"https://images.unsplash.com/photo-1509228468518-180dd4864904?w=800&h=500&fit=crop\"},{\"section\":\"Marco Teórico\",\"title\":\"Proceso de Poisson Compuesto\",\"bullets\":[\"Cada tumor puede tener múltiples mutaciones TP53\",\"N tumores llegan con tasa λ, cada uno con Xᵢ mutaciones\",\"S = Σᵢ₌₁ᴺ Xᵢ es el total de mutaciones observadas\",\"E[S] = λ·E[X], Var[S] = λ·E[X²]\"],\"image\":\"https://images.unsplash.com/photo-1579154204601-01588f351e67?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Estimación de λ Global\",\"highlight\":true,\"bullets\":[\"λ global = 1,101.64 ocurrencias/variante\",\"IC 95%: [1,101.28 , 1,101.99]\",\"Total eventos: 37,018,402\",\"Mediana: 508 (distribución muy sesgada)\"],\"image\":\"https://images.unsplash.com/photo-1551288049-bebda4e38f71?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Hotspots: CpG vs No-CpG\",\"bullets\":[\"λ sitios CpG = 1,931.93 (hotspots bioquímicos)\",\"λ no-CpG = 299.95\",\"Ratio CpG/no-CpG = 6.44× mayor\",\"Los dinucleótidos CpG son hipermutables por desaminación\"],\"image\":\"https://images.unsplash.com/photo-1614935151651-0bea6508db6b?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Top 5 Codones Mutados\",\"bullets\":[\"Codón 175: 9.3M eventos, λ=3,205\",\"Codón 248: 8.6M eventos, λ=2,189\",\"Codón 273: 8.4M eventos, λ=2,072\",\"Codón 282: 2.1M eventos, λ=1,398\"],\"image\":\"https://images.unsplash.com/photo-1530026405186-ed1f139313f8?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Validación: Sobredispersión\",\"bullets\":[\"Media: 1,101.64 | Varianza: 1,192,660\",\"Índice de dispersión = Var/Media = 1,082.6\",\"Sobredispersión EXTREMA detectada (≫1)\",\"Conclusión: Poisson simple NO es adecuado\"],\"image\":\"https://images.unsplash.com/photo-1460925895917-afdab827c52f?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Proceso No Homogéneo\",\"bullets\":[\"Modelo: λ(t) = 10,769.5 - 4.82·t\",\"R² = 0.184, p = 0.026 (significativo)\",\"Tendencia DECRECIENTE: -4.82 unidades/año\",\"Posible efecto de mejoras en secuenciación\"],\"image\":\"https://images.unsplash.com/photo-1543286386-713bdd548da4?w=800&h=500&fit=crop\"},{\"section\":\"Resultados\",\"title\":\"Proceso Compuesto: Mutaciones Múltiples\",\"bullets\":[\"84.0% de tumores tienen 1 sola mutación (SM)\",\"11.6% tienen doble mutación (DMU)\",\"4.2% tienen múltiples (MM)\",\"Media: 1.15 mutaciones/tumor\"],\"image\":\"https://images.unsplash.com/photo-1576086213369-97a306d36557?w=800&h=500&fit=crop\"},{\"section\":\"Conclusiones\",\"title\":\"Conclusiones\",\"bullets\":[\"Los datos requieren Poisson Compuesto por sobredispersión\",\"Los sitios CpG son hotspots con λ 6.44× mayor\",\"Solo 8 codones concentran la mayoría de mutaciones\",\"Tendencia temporal decreciente significativa\"],\"image\":\"https://images.unsplash.com/photo-1504868584819-f8e8b4b6d7e3?w=800&h=500&fit=crop\"},{\"section\":\"Aplicaciones\",\"title\":\"Aplicaciones Clínicas\",\"bullets\":[\"Priorización de paneles de secuenciación genética\",\"Detección temprana enfocada en hotspots R175, R248, R273\",\"Desarrollo de terapias dirigidas a mutaciones frecuentes\",\"Cálculo de probabilidad de mutación por codón\"],\"image\":\"https://images.unsplash.com/photo-1559757175-5700dde675bc?w=800&h=500&fit=crop\"}]";
const id = "informe";

  const slides = JSON.parse(slidesJson);
  let idx = 0;
  
  const container = document.getElementById(id);
  if (container) {
    const slideEl = container.querySelector('.informe-slide');
    const titleEl = container.querySelector('.slide-title');
    const bulletsEl = container.querySelector('.slide-bullets');
    const progressEl = container.querySelector('.slide-progress');
    const sectionEl = container.querySelector('.current-section');
    const sectionLabel = container.querySelector('.slide-section');
    const subtitleEl = container.querySelector('.slide-subtitle');
    const imageContainer = container.querySelector('.slide-image');
    const dotsContainer = container.querySelector('.slide-dots');
    
    function renderSlide() {
      const s = slides[idx];
      if (titleEl) titleEl.textContent = s.title;
      if (bulletsEl) bulletsEl.innerHTML = s.bullets.map(b => "<li>" + b + "</li>").join("");
      if (progressEl) progressEl.textContent = (idx + 1) + " / " + slides.length;
      if (sectionEl) sectionEl.textContent = s.section;
      if (sectionLabel) sectionLabel.textContent = s.section;
      
      if (subtitleEl) {
        if (s.subtitle) { subtitleEl.textContent = s.subtitle; subtitleEl.style.display = "block"; }
        else { subtitleEl.style.display = "none"; }
      }
      
      if (imageContainer) {
        if (s.image) { imageContainer.innerHTML = '<img src="' + s.image + '" alt="" />'; }
      }
      
      if (slideEl) {
        slideEl.classList.toggle("highlight", s.highlight === true);
        slideEl.classList.toggle("code-slide", s.code === true);
        slideEl.classList.toggle("formula-slide", s.isFormula === true);
      }
      
      if (dotsContainer) {
        dotsContainer.querySelectorAll(".dot").forEach((d, i) => {
          d.classList.toggle("active", i === idx);
        });
      }
    }
    
    container.querySelector(".prev-btn")?.addEventListener("click", () => { 
      idx = (idx - 1 + slides.length) % slides.length; 
      renderSlide(); 
    });
    
    container.querySelector(".next-btn")?.addEventListener("click", () => { 
      idx = (idx + 1) % slides.length; 
      renderSlide(); 
    });
    
    dotsContainer?.querySelectorAll(".dot").forEach(d => {
      d.addEventListener("click", (e) => { 
        idx = parseInt(e.target.dataset.index); 
        renderSlide(); 
      });
    });
    
    document.addEventListener("keydown", (e) => {
      const rect = container.getBoundingClientRect();
      const inView = rect.top < window.innerHeight && rect.bottom > 0;
      if (!inView) return;
      if (e.key === "ArrowLeft") { idx = (idx - 1 + slides.length) % slides.length; renderSlide(); }
      if (e.key === "ArrowRight") { idx = (idx + 1) % slides.length; renderSlide(); }
    });
  }
})();</script>  <!-- ANIMACIÓN: GEN TP53 CON MUTACIONES --> <section class="gene-anim-section" id="animacion" data-astro-cid-oimuypky> <div class="section__head" data-astro-cid-oimuypky> <div data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Visualización Interactiva</p> <h2 data-astro-cid-oimuypky>Mutaciones en el Gen TP53</h2> <p class="section__lede" data-astro-cid-oimuypky>Observa cómo las mutaciones caen sobre los codones del gen. Los <strong data-astro-cid-oimuypky>hotspots</strong> (CpG) atraen más mutaciones.</p> </div> </div> <div class="gene-anim-wrapper" data-astro-cid-oimuypky> <div class="gene-params" data-astro-cid-oimuypky> <span id="gene-params-text" data-astro-cid-oimuypky>λ = 15.0 mut/s · Hotspot ratio: 11×</span> </div> <canvas id="gene-canvas" width="900" height="450" data-astro-cid-oimuypky></canvas> <div class="gene-legend" data-astro-cid-oimuypky> <div class="legend-item" data-astro-cid-oimuypky><span class="legend-dot hotspot" data-astro-cid-oimuypky></span> Hotspot (CpG) - λ alto</div> <div class="legend-item" data-astro-cid-oimuypky><span class="legend-dot normal" data-astro-cid-oimuypky></span> Codón normal - λ bajo</div> <div class="legend-item" data-astro-cid-oimuypky><span class="legend-dot mutation" data-astro-cid-oimuypky></span> Mutación</div> </div> <div class="gene-controls" data-astro-cid-oimuypky> <div class="slider-group" data-astro-cid-oimuypky> <label data-astro-cid-oimuypky> <span data-astro-cid-oimuypky>λ base (mut/s)</span> <input type="range" id="gene-lambda" min="5" max="40" step="1" value="15" data-astro-cid-oimuypky> <span class="slider-val" id="gene-lambda-val" data-astro-cid-oimuypky>15</span> </label> <label data-astro-cid-oimuypky> <span data-astro-cid-oimuypky>Ratio CpG/Normal</span> <input type="range" id="gene-ratio" min="2" max="15" step="1" value="11" data-astro-cid-oimuypky> <span class="slider-val" id="gene-ratio-val" data-astro-cid-oimuypky>11×</span> </label> </div> <div class="gene-btns" data-astro-cid-oimuypky> <button id="gene-start" class="btn-start" data-astro-cid-oimuypky>▶ Iniciar</button> <button id="gene-reset" class="btn-reset" data-astro-cid-oimuypky>↺ Reset</button> </div> </div> <div class="gene-stats" data-astro-cid-oimuypky> <div class="gstat" data-astro-cid-oimuypky><span class="gstat-label" data-astro-cid-oimuypky>Total mutaciones</span><span class="gstat-value" id="gstat-total" data-astro-cid-oimuypky>0</span></div> <div class="gstat hotspot" data-astro-cid-oimuypky><span class="gstat-label" data-astro-cid-oimuypky>En hotspots</span><span class="gstat-value" id="gstat-hotspot" data-astro-cid-oimuypky>0</span></div> <div class="gstat" data-astro-cid-oimuypky><span class="gstat-label" data-astro-cid-oimuypky>En normales</span><span class="gstat-value" id="gstat-normal" data-astro-cid-oimuypky>0</span></div> <div class="gstat" data-astro-cid-oimuypky><span class="gstat-label" data-astro-cid-oimuypky>Top codón</span><span class="gstat-value" id="gstat-top" data-astro-cid-oimuypky>—</span></div> </div> </div> </section> <!-- SIMULADOR INTERACTIVO --> <section class="simulator" id="simulador" data-astro-cid-oimuypky> <div class="section__head" data-astro-cid-oimuypky> <div data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Simulación de Mutaciones</p> <h2 data-astro-cid-oimuypky>Visualización: Poisson Homogéneo vs No Homogéneo</h2> <p class="section__lede" data-astro-cid-oimuypky>Observá cómo las <strong data-astro-cid-oimuypky>mutaciones</strong> ocurren aleatoriamente. Compará un proceso con tasa constante vs uno con tasa decreciente.</p> </div> </div> <div class="sim-container" data-astro-cid-oimuypky> <div class="sim-controls" data-astro-cid-oimuypky> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Tasa de mutación λ</label><input type="range" id="sim-lambda" min="5" max="50" value="20" step="1" data-astro-cid-oimuypky><span id="sim-lambda-val" data-astro-cid-oimuypky>20 mut/año</span></div> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Pendiente temporal (b)</label><input type="range" id="sim-slope" min="-2" max="2" value="-0.5" step="0.1" data-astro-cid-oimuypky><span id="sim-slope-val" data-astro-cid-oimuypky>-0.5</span></div> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Tiempo (años)</label><input type="range" id="sim-time" min="5" max="30" value="20" step="1" data-astro-cid-oimuypky><span id="sim-time-val" data-astro-cid-oimuypky>20 años</span></div> <button id="sim-run" class="sim-btn pulse" data-astro-cid-oimuypky><span class="btn-icon" data-astro-cid-oimuypky>▶</span> Generar Mutaciones</button> </div> <div class="sim-stats" data-astro-cid-oimuypky> <div class="stat-box hom" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>Homogéneo</span><span class="stat-value" id="stat-hom-count" data-astro-cid-oimuypky>0</span><span class="stat-unit" data-astro-cid-oimuypky>mutaciones</span></div> <div class="stat-box nhom" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>No Homogéneo</span><span class="stat-value" id="stat-nhom-count" data-astro-cid-oimuypky>0</span><span class="stat-unit" data-astro-cid-oimuypky>mutaciones</span></div> <div class="stat-box diff" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>Diferencia</span><span class="stat-value" id="stat-diff" data-astro-cid-oimuypky>0%</span><span class="stat-unit" data-astro-cid-oimuypky>más/menos</span></div> </div> <div class="sim-charts-grid" data-astro-cid-oimuypky> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header hom" data-astro-cid-oimuypky><span class="chart-dot" data-astro-cid-oimuypky></span><h4 data-astro-cid-oimuypky>Poisson Homogéneo (λ constante)</h4></div><div id="chart-mutations-hom" class="mutation-chart" data-astro-cid-oimuypky></div></div> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header nhom" data-astro-cid-oimuypky><span class="chart-dot" data-astro-cid-oimuypky></span><h4 data-astro-cid-oimuypky>Poisson No Homogéneo (λ(t) decreciente)</h4></div><div id="chart-mutations-nhom" class="mutation-chart" data-astro-cid-oimuypky></div></div> </div> <div class="chart-box wide" data-astro-cid-oimuypky><div class="chart-header comparison" data-astro-cid-oimuypky><span class="chart-icon" data-astro-cid-oimuypky>≡</span><h4 data-astro-cid-oimuypky>Comparación: Mutaciones Acumuladas N(t)</h4></div><div id="chart-cumulative" class="mutation-chart tall" data-astro-cid-oimuypky></div></div> <div class="sim-charts-grid" data-astro-cid-oimuypky> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header hom" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Distribución de Intervalos (Homogéneo)</h4></div><div id="chart-intervals-hom" class="mutation-chart" data-astro-cid-oimuypky></div></div> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header nhom" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Distribución de Intervalos (No Homogéneo)</h4></div><div id="chart-intervals-nhom" class="mutation-chart" data-astro-cid-oimuypky></div></div> </div> <div class="sim-formulas" data-astro-cid-oimuypky> <div class="formula-box hom-box" data-astro-cid-oimuypky><h5 data-astro-cid-oimuypky>Proceso Homogéneo</h5><div class="formula-content" id="formula-hom" data-astro-cid-oimuypky></div></div> <div class="formula-box nhom-box" data-astro-cid-oimuypky><h5 data-astro-cid-oimuypky>Proceso No Homogéneo</h5><div class="formula-content" id="formula-nhom" data-astro-cid-oimuypky></div></div> </div> </div> </section> <!-- GRÁFICOS INTERACTIVOS --> <section class="charts-section" id="graficos" data-astro-cid-oimuypky> <div class="section__head" data-astro-cid-oimuypky> <div data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Visualizaciones</p> <h2 data-astro-cid-oimuypky>Gráficos Interactivos del Dataset TP53</h2> <p class="section__lede" data-astro-cid-oimuypky>Datos reales de 76,696 variantes del gen TP53 (después de limpieza).</p> </div> </div> <div class="charts-grid" data-astro-cid-oimuypky> <div class="chart-card wide" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Hotspots Mutacionales: Top 8 Codones</h4><div id="chart-hotspots" class="plotly-chart" data-astro-cid-oimuypky></div></div> <div class="chart-card" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Comparación CpG vs No-CpG</h4><div id="chart-cpg" class="plotly-chart" data-astro-cid-oimuypky></div></div> <div class="chart-card" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Tasa λ por Tipo de Cáncer</h4><div id="chart-disease" class="plotly-chart" data-astro-cid-oimuypky></div></div> <div class="chart-card wide" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Evolución Temporal de λ (Proceso No Homogéneo)</h4><div id="chart-temporal" class="plotly-chart" data-astro-cid-oimuypky></div></div> </div> </section> <!-- PROCESO DE POISSON COMPUESTO --> <section class="compound-section" id="compuesto" data-astro-cid-oimuypky> <div class="section__head" data-astro-cid-oimuypky> <div data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Procesos Compuestos</p> <h2 data-astro-cid-oimuypky>Simulación: Proceso de Poisson Compuesto</h2> <p class="section__lede" data-astro-cid-oimuypky>Modelo donde cada tumor puede tener <strong data-astro-cid-oimuypky>múltiples mutaciones</strong>. El total S = Σᵢ Xᵢ donde N(t) es el número de tumores.</p> </div> </div> <div class="compound-container" data-astro-cid-oimuypky> <div class="compound-controls" data-astro-cid-oimuypky> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Tasa de tumores (λ)</label><input type="range" id="comp-lambda" min="10" max="100" value="50" step="5" data-astro-cid-oimuypky><span id="comp-lambda-val" data-astro-cid-oimuypky>50 tumores/u.t.</span></div> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Media mutaciones/tumor (μₓ)</label><input type="range" id="comp-mu" min="1" max="3" value="1.15" step="0.05" data-astro-cid-oimuypky><span id="comp-mu-val" data-astro-cid-oimuypky>1.15</span></div> <div class="control-group" data-astro-cid-oimuypky><label data-astro-cid-oimuypky>Tiempo de simulación</label><input type="range" id="comp-time" min="10" max="50" value="30" step="5" data-astro-cid-oimuypky><span id="comp-time-val" data-astro-cid-oimuypky>30 u.t.</span></div> <button id="comp-run" class="sim-btn compound-btn" data-astro-cid-oimuypky><span class="btn-icon" data-astro-cid-oimuypky>▶</span> Simular Proceso Compuesto</button> </div> <div class="compound-stats" data-astro-cid-oimuypky> <div class="stat-box tumors" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>Tumores N(t)</span><span class="stat-value" id="stat-tumors" data-astro-cid-oimuypky>0</span><span class="stat-unit" data-astro-cid-oimuypky>llegados</span></div> <div class="stat-box mutations" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>Total S(t)</span><span class="stat-value" id="stat-total-muts" data-astro-cid-oimuypky>0</span><span class="stat-unit" data-astro-cid-oimuypky>mutaciones</span></div> <div class="stat-box expected" data-astro-cid-oimuypky><span class="stat-label" data-astro-cid-oimuypky>E[S(t)] teórico</span><span class="stat-value" id="stat-expected" data-astro-cid-oimuypky>0</span><span class="stat-unit" data-astro-cid-oimuypky>λt·μₓ</span></div> </div> <div class="compound-charts" data-astro-cid-oimuypky> <div class="chart-box compound-wide" data-astro-cid-oimuypky><div class="chart-header compound-header" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Proceso Compuesto: Mutaciones Acumuladas S(t)</h4></div><div id="chart-compound-cumulative" class="mutation-chart tall" data-astro-cid-oimuypky></div></div> <div class="compound-grid" data-astro-cid-oimuypky> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Distribución de Mutaciones por Tumor</h4></div><div id="chart-compound-dist" class="mutation-chart" data-astro-cid-oimuypky></div></div> <div class="chart-box" data-astro-cid-oimuypky><div class="chart-header" data-astro-cid-oimuypky><h4 data-astro-cid-oimuypky>Datos Reales: Complejidad Mutacional</h4></div><div id="chart-real-complexity" class="mutation-chart" data-astro-cid-oimuypky></div></div> </div> </div> <div class="compound-theory" data-astro-cid-oimuypky> <div class="theory-box" data-astro-cid-oimuypky><h5 data-astro-cid-oimuypky>Fórmulas del Proceso Compuesto</h5> <div class="formula-grid" data-astro-cid-oimuypky> <div class="formula-item" data-astro-cid-oimuypky><span class="formula-label" data-astro-cid-oimuypky>Esperanza:</span><span class="formula-eq" id="formula-es" data-astro-cid-oimuypky></span></div> <div class="formula-item" data-astro-cid-oimuypky><span class="formula-label" data-astro-cid-oimuypky>Varianza:</span><span class="formula-eq" id="formula-var" data-astro-cid-oimuypky></span></div> </div> </div> <div class="real-data-box" data-astro-cid-oimuypky> <h5 data-astro-cid-oimuypky>Datos Reales del Dataset TP53</h5> <div class="real-stats" data-astro-cid-oimuypky> <div class="real-item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>λ simples (SM)</span><span class="value" data-astro-cid-oimuypky>689.76</span></div> <div class="real-item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>λ múltiples</span><span class="value" data-astro-cid-oimuypky>411.45</span></div> <div class="real-item accent" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>84% tumores</span><span class="value" data-astro-cid-oimuypky>1 mut.</span></div> <div class="real-item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Media/tumor</span><span class="value" data-astro-cid-oimuypky>1.15</span></div> </div> </div> </div> </div> </section> <!-- ANÁLISIS --> <section class="analysis" id="analisis" data-astro-cid-oimuypky> <div class="section__head" data-astro-cid-oimuypky> <div data-astro-cid-oimuypky> <p class="eyebrow" data-astro-cid-oimuypky>Análisis Completo</p> <h2 data-astro-cid-oimuypky>Resultados del Jupyter Notebook</h2> </div> </div> <div class="analysis-grid" data-astro-cid-oimuypky> <div class="analysis-card" data-astro-cid-oimuypky> <div class="card-header" data-astro-cid-oimuypky><span class="module-num" data-astro-cid-oimuypky>01</span><h4 data-astro-cid-oimuypky>Estadísticas Descriptivas</h4></div> <table class="data-table" data-astro-cid-oimuypky> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>Total variantes únicas</td><td class="val" data-astro-cid-oimuypky>33,603</td></tr> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>Total eventos</td><td class="val" data-astro-cid-oimuypky>37,018,402</td></tr> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>Media (λ global)</td><td class="val" data-astro-cid-oimuypky>1,101.64</td></tr> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>Mediana</td><td class="val" data-astro-cid-oimuypky>508.00</td></tr> </table> </div> <div class="analysis-card highlight" data-astro-cid-oimuypky> <div class="card-header" data-astro-cid-oimuypky><span class="module-num" data-astro-cid-oimuypky>02</span><h4 data-astro-cid-oimuypky>Estimación de λ</h4></div> <div class="param-box" data-astro-cid-oimuypky><span class="param-label" data-astro-cid-oimuypky>λ Global</span><span class="param-value" data-astro-cid-oimuypky>1,101.64</span><span class="param-ci" data-astro-cid-oimuypky>IC 95%: [1,101.28 , 1,101.99]</span></div> <div class="param-row" data-astro-cid-oimuypky> <div class="param-item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>λ CpG</span><span class="value" data-astro-cid-oimuypky>1,931.93</span></div> <div class="param-item" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>λ No-CpG</span><span class="value" data-astro-cid-oimuypky>299.95</span></div> <div class="param-item accent" data-astro-cid-oimuypky><span class="label" data-astro-cid-oimuypky>Ratio</span><span class="value" data-astro-cid-oimuypky>6.44×</span></div> </div> </div> <div class="analysis-card warning" data-astro-cid-oimuypky> <div class="card-header" data-astro-cid-oimuypky><span class="module-num" data-astro-cid-oimuypky>03</span><h4 data-astro-cid-oimuypky>Validación del Modelo</h4></div> <div class="validation-grid" data-astro-cid-oimuypky> <div class="val-metric" data-astro-cid-oimuypky><span class="metric-label" data-astro-cid-oimuypky>Media</span><span class="metric-value" data-astro-cid-oimuypky>1,101.64</span></div> <div class="val-metric" data-astro-cid-oimuypky><span class="metric-label" data-astro-cid-oimuypky>Varianza</span><span class="metric-value" data-astro-cid-oimuypky>1,192,660</span></div> <div class="val-metric big warning" data-astro-cid-oimuypky><span class="metric-label" data-astro-cid-oimuypky>Índice</span><span class="metric-value" data-astro-cid-oimuypky>1,082.6</span></div> </div> <div class="conclusion warning" data-astro-cid-oimuypky><strong data-astro-cid-oimuypky>SOBREDISPERSIÓN:</strong> Poisson simple NO adecuado.</div> </div> <div class="analysis-card" data-astro-cid-oimuypky> <div class="card-header" data-astro-cid-oimuypky><span class="module-num" data-astro-cid-oimuypky>04</span><h4 data-astro-cid-oimuypky>Proceso No Homogéneo</h4></div> <div class="model-box" data-astro-cid-oimuypky><span class="model-label" data-astro-cid-oimuypky>Modelo:</span><span class="model-formula" id="model-temporal" data-astro-cid-oimuypky></span></div> <table class="data-table" data-astro-cid-oimuypky> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>Pendiente (b)</td><td class="val" data-astro-cid-oimuypky>-4.82 /año</td></tr> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>R²</td><td class="val" data-astro-cid-oimuypky>0.184</td></tr> <tr data-astro-cid-oimuypky><td data-astro-cid-oimuypky>p-value</td><td class="val" data-astro-cid-oimuypky>0.026 (significativo)</td></tr> </table> <div class="conclusion" style="margin-top:12px;background:rgba(244,63,94,0.08);border-color:#f43f5e;" data-astro-cid-oimuypky><strong data-astro-cid-oimuypky>CONCLUSIÓN:</strong> Tendencia temporal DECRECIENTE significativa. Posible efecto de mejoras en técnicas de secuenciación.</div> </div> </div> </section> <section class="code-section" id="codigo" data-astro-cid-kkraiuss> <div class="section__head" data-astro-cid-kkraiuss> <div data-astro-cid-kkraiuss> <p class="eyebrow" data-astro-cid-kkraiuss>Código Fuente</p> <h2 data-astro-cid-kkraiuss>Jupyter Notebook: Análisis Completo</h2> <p class="section__lede" data-astro-cid-kkraiuss>Código Python del análisis estadístico. Datos: <code>mutaciones_es.xlsx</code></p> </div> </div>  <div class="code-file" data-astro-cid-kkraiuss> <div class="code-header" data-astro-cid-kkraiuss> <span class="code-filename" data-astro-cid-kkraiuss>poisson_analysis.py</span> <span class="code-desc" data-astro-cid-kkraiuss>Estimación de λ y validación</span> </div> <pre class="code-block" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss># Estimación de parámetros λ del Proceso de Poisson
import numpy as np
from scipy import stats

def estimate_lambda_with_ci(data, confidence=0.95):
    n = len(data)
    lambda_est = data.mean()
    sum_x = data.sum()
    alpha = 1 - confidence
    lower = stats.chi2.ppf(alpha/2, 2*sum_x) / (2*n)
    upper = stats.chi2.ppf(1-alpha/2, 2*(sum_x+1)) / (2*n)
    return lambda_est, lower, upper

# Resultados del dataset TP53
lambda_global, ci_lower, ci_upper = estimate_lambda_with_ci(df['Número_Ocurrencias'])
# λ = 1101.64, IC 95%: [1101.28, 1101.99]

# Índice de dispersión (test de equidispersión)
mean_val = df['Número_Ocurrencias'].mean()  # 1101.64
var_val = df['Número_Ocurrencias'].var()    # 1192660.46
dispersion_index = var_val / mean_val       # 1082.62
# CONCLUSIÓN: Sobredispersión extrema (1082 >> 1)</code></pre> </div><div class="code-file" data-astro-cid-kkraiuss> <div class="code-header" data-astro-cid-kkraiuss> <span class="code-filename" data-astro-cid-kkraiuss>poisson_no_homogeneo.py</span> <span class="code-desc" data-astro-cid-kkraiuss>Modelo temporal λ(t) = a + b·t</span> </div> <pre class="code-block" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss># Modelado de Proceso de Poisson No Homogéneo
from scipy.stats import linregress
import numpy as np

# Agrupar λ promedio por año (1989-2016)
yearly = df.groupby('Año')['Número_Ocurrencias'].mean()

# Ajuste de regresión lineal
slope, intercept, r_value, p_value, std_err = linregress(
    yearly.index, yearly.values
)

# Resultados:
# Intercepto (a) = 10,769.53
# Pendiente (b)  = -4.82
# R² = 0.184
# p-value = 0.026 (significativo al 5%)

# Modelo: λ(t) = 10,769.5 - 4.82·t
# Tendencia DECRECIENTE significativa</code></pre> </div> <div class="code-run" data-astro-cid-kkraiuss> <div class="run-header" data-astro-cid-kkraiuss> <span class="run-icon" data-astro-cid-kkraiuss>▶</span> <span data-astro-cid-kkraiuss>Ejecutar</span> </div> <pre class="run-commands" data-astro-cid-kkraiuss><code data-astro-cid-kkraiuss>pip install pandas numpy scipy matplotlib seaborn openpyxl
jupyter notebook &quot;25 (1).ipynb&quot;</code></pre> </div> </section>  </main> <footer class="footer" data-astro-cid-sz7xmlte> <span data-astro-cid-sz7xmlte>Universidad Mayor de San Andrés · 2025</span> <span data-astro-cid-sz7xmlte>Proyecto 25 · Procesos de Poisson</span> </footer>   </div> <div id="tsparticles" style="--accentColor: #22d3ee;--accentColor2: #a78bfa;"></div>  <script>
    window.addEventListener("load", () => {
      if (window.tsParticles) {
        const accent = getComputedStyle(document.body).getPropertyValue('--accent').trim() || '#10b981';
        const accent2 = getComputedStyle(document.body).getPropertyValue('--accent-2').trim() || '#3b82f6';
        
        window.tsParticles.load("tsparticles", {
          fpsLimit: 60, fullScreen: { enable: false },
          particles: {
            number: { value: 60, density: { enable: true, area: 900 } },
            color: { value: [accent, accent2, "#8b5cf6"] },
            links: { enable: true, distance: 140, color: accent, opacity: 0.25, width: 1 },
            move: { enable: true, speed: 1.2, outModes: "out" },
            opacity: { value: { min: 0.2, max: 0.5 } },
            size: { value: { min: 1.5, max: 3 } }
          },
          interactivity: { events: { onHover: { enable: true, mode: "grab" } } },
          detectRetina: true
        });
      }
    });
  </script>  </body></html> <script>(function(){const hotspotsCodones = [{"codon":175,"eventos":9288241,"lambda":3205.05},{"codon":248,"eventos":8595606,"lambda":2188.85},{"codon":273,"eventos":8443026,"lambda":2072.42},{"codon":282,"eventos":2088720,"lambda":1398.07},{"codon":245,"eventos":1458766,"lambda":813.14},{"codon":220,"eventos":1313082,"lambda":1201.36},{"codon":213,"eventos":1220078,"lambda":1102.15},{"codon":196,"eventos":582823,"lambda":812.86}];
const enfermedadLambda = [{"enfermedad":"Colorectal","lambda":1552.72,"n":4901},{"enfermedad":"Glioblastoma","lambda":1290,"n":1053},{"enfermedad":"Gástrico","lambda":1293.8,"n":1028},{"enfermedad":"Pancreático","lambda":1198.63,"n":802},{"enfermedad":"Ovario","lambda":1139.72,"n":2026},{"enfermedad":"Mama","lambda":1069.4,"n":3878},{"enfermedad":"Cabeza/Cuello","lambda":990.59,"n":2682},{"enfermedad":"Esófago","lambda":960.64,"n":1188},{"enfermedad":"Vejiga","lambda":875.43,"n":1171},{"enfermedad":"Pulmón NSCLC","lambda":647.54,"n":2894}];
const datosTemporal = [{"year":1989,"lambda":1180},{"year":1990,"lambda":1250},{"year":1991,"lambda":1320},{"year":1992,"lambda":1200},{"year":1993,"lambda":1150},{"year":1994,"lambda":1280},{"year":1995,"lambda":1180},{"year":1996,"lambda":1220},{"year":1997,"lambda":1100},{"year":1998,"lambda":1080},{"year":1999,"lambda":1150},{"year":2000,"lambda":1200},{"year":2001,"lambda":1050},{"year":2002,"lambda":1120},{"year":2003,"lambda":1080},{"year":2004,"lambda":1040},{"year":2005,"lambda":1000},{"year":2006,"lambda":1100},{"year":2007,"lambda":1050},{"year":2008,"lambda":1020},{"year":2009,"lambda":980},{"year":2010,"lambda":950},{"year":2011,"lambda":1000},{"year":2012,"lambda":980},{"year":2013,"lambda":920},{"year":2014,"lambda":950},{"year":2015,"lambda":900},{"year":2016,"lambda":880}];
const cpgComparison = {"lambdaCpg":1931.93,"lambdaNoCpg":299.95,"ratio":6.44};
const datosCompuesto = {"complejidad":[{"tipo":"SM (Simple)","porcentaje":84,"count":64422,"lambda":689.76},{"tipo":"DMU (Doble)","porcentaje":11.6,"count":8894,"lambda":411.45},{"tipo":"MM (Multiple)","porcentaje":4.21,"count":3229,"lambda":360.2},{"tipo":"DMD/DMS","porcentaje":0.19,"count":151,"lambda":298.5}],"repeticiones":[{"muts":1,"tumores":64420,"pct":83.99},{"muts":2,"tumores":9043,"pct":11.79},{"muts":3,"tumores":1727,"pct":2.25},{"muts":4,"tumores":654,"pct":0.85},{"muts":5,"tumores":228,"pct":0.3},{"muts":6,"tumores":136,"pct":0.18},{"muts":7,"tumores":85,"pct":0.11},{"muts":8,"tumores":72,"pct":0.09}],"mediaByTumor":1.15,"lambdaSimple":689.76,"lambdaMultiple":411.45,"ratioSimpleMultiple":0.6};

  window.hotspotsCodones = hotspotsCodones;
  window.enfermedadLambda = enfermedadLambda;
  window.datosTemporal = datosTemporal;
  window.cpgComparison = cpgComparison;
  window.datosCompuesto = datosCompuesto;
})();</script> <script>
// Animación Gen TP53 con mutaciones
(function() {
  const canvas = document.getElementById('gene-canvas');
  if (!canvas) return;
  const ctx = canvas.getContext('2d');
  
  let lambdaBase = 15, hotspotRatio = 11;
  let running = false;
  let mutations = []; // { x, y, targetCodon, falling, landed }
  let codons = []; // { x, y, isHotspot, name, mutationCount, balls }
  let totalMutations = 0, hotspotMutations = 0, normalMutations = 0;
  let nextMutation = 0;
  let simTime = 0;
  
  const colors = {
    bg: '#0d1117',
    grid: 'rgba(255,255,255,0.02)',
    chain: '#1e3a5f',
    codonNormal: '#3b82f6',
    codonHotspot: '#f43f5e',
    mutation: '#22d3ee',
    mutationHotspot: '#fbbf24',
    text: '#64748b',
    textBright: '#e2e8f0'
  };
  
  // Codones del gen TP53 (simplificado)
  const codonData = [
    { name: '72', isHotspot: false },
    { name: '175', isHotspot: true },  // R175H - hotspot
    { name: '196', isHotspot: false },
    { name: '213', isHotspot: false },
    { name: '220', isHotspot: false },
    { name: '245', isHotspot: true },  // G245S - hotspot
    { name: '248', isHotspot: true },  // R248Q - hotspot MAJOR
    { name: '249', isHotspot: false },
    { name: '273', isHotspot: true },  // R273H - hotspot MAJOR
    { name: '275', isHotspot: false },
    { name: '282', isHotspot: true },  // R282W - hotspot
    { name: '306', isHotspot: false }
  ];
  
  function initCodons() {
    codons = [];
    const startX = 80;
    const spacing = 68;
    const y = canvas.height - 120;
    
    codonData.forEach((c, i) => {
      codons.push({
        x: startX + i * spacing,
        y: y,
        isHotspot: c.isHotspot,
        name: c.name,
        mutationCount: 0,
        balls: [] // pequeñas bolitas del codón
      });
    });
    
    // Crear bolitas para cada codón (representación del gen)
    codons.forEach(codon => {
      const numBalls = 5;
      for (let i = 0; i < numBalls; i++) {
        const angle = (i / numBalls) * Math.PI * 2;
        const r = 18;
        codon.balls.push({
          ox: Math.cos(angle) * r,
          oy: Math.sin(angle) * r * 0.6
        });
      }
    });
  }
  
  function randExp(rate) {
    return -Math.log(1 - Math.random()) / rate;
  }
  
  function lerp(a, b, t) {
    return a + (b - a) * Math.min(1, t);
  }
  
  function drawBackground() {
    ctx.fillStyle = colors.bg;
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    
    // Grid
    ctx.strokeStyle = colors.grid;
    ctx.lineWidth = 1;
    for (let x = 0; x < canvas.width; x += 50) {
      ctx.beginPath(); ctx.moveTo(x, 0); ctx.lineTo(x, canvas.height); ctx.stroke();
    }
    for (let y = 0; y < canvas.height; y += 50) {
      ctx.beginPath(); ctx.moveTo(0, y); ctx.lineTo(canvas.width, y); ctx.stroke();
    }
    
    // Título
    ctx.fillStyle = colors.textBright;
    ctx.font = 'bold 14px Manrope, system-ui, sans-serif';
    ctx.textAlign = 'center';
    ctx.fillText('Gen TP53 - Codones Principales', canvas.width / 2, 30);
  }
  
  function drawChain() {
    // Línea de conexión (cadena del gen)
    ctx.strokeStyle = colors.chain;
    ctx.lineWidth = 8;
    ctx.lineCap = 'round';
    ctx.beginPath();
    ctx.moveTo(codons[0].x - 40, codons[0].y);
    codons.forEach(c => {
      ctx.lineTo(c.x, c.y);
    });
    ctx.lineTo(codons[codons.length - 1].x + 40, codons[codons.length - 1].y);
    ctx.stroke();
    
    // Dibujar cada codón como grupo de bolitas
    codons.forEach(codon => {
      const baseColor = codon.isHotspot ? colors.codonHotspot : colors.codonNormal;
      const glowColor = codon.isHotspot ? 'rgba(244,63,94,0.3)' : 'rgba(59,130,246,0.2)';
      
      // Glow para hotspots
      if (codon.isHotspot) {
        ctx.beginPath();
        ctx.arc(codon.x, codon.y, 35, 0, Math.PI * 2);
        ctx.fillStyle = glowColor;
        ctx.fill();
      }
      
      // Bolitas del codón
      codon.balls.forEach(ball => {
        ctx.beginPath();
        ctx.arc(codon.x + ball.ox, codon.y + ball.oy, 8, 0, Math.PI * 2);
        ctx.fillStyle = baseColor;
        ctx.fill();
        ctx.strokeStyle = 'rgba(255,255,255,0.3)';
        ctx.lineWidth = 1.5;
        ctx.stroke();
      });
      
      // Centro del codón
      ctx.beginPath();
      ctx.arc(codon.x, codon.y, 10, 0, Math.PI * 2);
      ctx.fillStyle = baseColor;
      ctx.fill();
      
      // Etiqueta
      ctx.fillStyle = colors.text;
      ctx.font = '11px Manrope, system-ui, sans-serif';
      ctx.textAlign = 'center';
      ctx.fillText(codon.name, codon.x, codon.y + 50);
      
      // Contador de mutaciones
      if (codon.mutationCount > 0) {
        ctx.fillStyle = codon.isHotspot ? colors.mutationHotspot : colors.mutation;
        ctx.font = 'bold 12px Manrope, system-ui, sans-serif';
        ctx.fillText(codon.mutationCount, codon.x, codon.y - 45);
      }
    });
  }
  
  function drawMutations() {
    mutations.forEach(m => {
      if (!m.landed) {
        // Mutación cayendo
        ctx.beginPath();
        ctx.arc(m.x, m.y, 6, 0, Math.PI * 2);
        ctx.fillStyle = colors.mutation;
        ctx.fill();
        
        // Estela
        ctx.beginPath();
        ctx.moveTo(m.x, m.y - 5);
        ctx.lineTo(m.x, m.y - 20);
        ctx.strokeStyle = 'rgba(34,211,238,0.4)';
        ctx.lineWidth = 3;
        ctx.stroke();
      }
    });
    
    // Dibujar mutaciones acumuladas en codones
    codons.forEach(codon => {
      const landed = mutations.filter(m => m.landed && m.targetCodon === codon.name);
      landed.forEach((m, i) => {
        const row = Math.floor(i / 5);
        const col = i % 5;
        const px = codon.x - 12 + col * 6;
        const py = codon.y - 60 - row * 6;
        
        ctx.beginPath();
        ctx.arc(px, py, 3, 0, Math.PI * 2);
        ctx.fillStyle = codon.isHotspot ? colors.mutationHotspot : colors.mutation;
        ctx.fill();
      });
    });
  }
  
  function spawnMutation() {
    // Calcular probabilidades basadas en si es hotspot
    const weights = codons.map(c => c.isHotspot ? hotspotRatio : 1);
    const totalWeight = weights.reduce((a, b) => a + b, 0);
    
    let rand = Math.random() * totalWeight;
    let targetCodon = codons[0];
    for (let i = 0; i < codons.length; i++) {
      rand -= weights[i];
      if (rand <= 0) {
        targetCodon = codons[i];
        break;
      }
    }
    
    mutations.push({
      x: targetCodon.x + (Math.random() - 0.5) * 20,
      y: -10,
      targetX: targetCodon.x,
      targetY: targetCodon.y - 30,
      targetCodon: targetCodon.name,
      falling: true,
      landed: false,
      speed: 150 + Math.random() * 100
    });
  }
  
  function updateMutations(dt) {
    mutations.forEach(m => {
      if (m.falling && !m.landed) {
        m.y += m.speed * dt;
        
        // Ajustar x hacia el objetivo
        m.x = lerp(m.x, m.targetX, dt * 3);
        
        if (m.y >= m.targetY) {
          m.y = m.targetY;
          m.falling = false;
          m.landed = true;
          
          // Incrementar contador del codón
          const codon = codons.find(c => c.name === m.targetCodon);
          if (codon) {
            codon.mutationCount++;
            totalMutations++;
            if (codon.isHotspot) hotspotMutations++;
            else normalMutations++;
          }
        }
      }
    });
    
    // Limitar mutaciones visibles
    if (mutations.length > 300) {
      mutations = mutations.slice(-300);
    }
  }
  
  function updateStats() {
    document.getElementById('gstat-total').textContent = totalMutations;
    document.getElementById('gstat-hotspot').textContent = hotspotMutations;
    document.getElementById('gstat-normal').textContent = normalMutations;
    
    // Encontrar top codón
    const topCodon = codons.reduce((max, c) => c.mutationCount > max.mutationCount ? c : max, codons[0]);
    document.getElementById('gstat-top').textContent = topCodon.mutationCount > 0 ? `${topCodon.name} (${topCodon.mutationCount})` : '—';
  }
  
  function updateParamsText() {
    document.getElementById('gene-params-text').textContent = 
      `λ = ${lambdaBase.toFixed(1)} mut/s · Hotspot ratio: ${hotspotRatio}×`;
  }
  
  let lastTime = 0;
  function loop(timestamp) {
    if (!running) return;
    
    const dt = lastTime ? (timestamp - lastTime) / 1000 : 0.016;
    lastTime = timestamp;
    
    simTime += dt;
    
    // Generar mutaciones
    if (simTime >= nextMutation) {
      spawnMutation();
      nextMutation = simTime + randExp(lambdaBase);
    }
    
    updateMutations(dt);
    
    drawBackground();
    drawChain();
    drawMutations();
    updateStats();
    
    requestAnimationFrame(loop);
  }
  
  function reset() {
    mutations = [];
    totalMutations = 0;
    hotspotMutations = 0;
    normalMutations = 0;
    simTime = 0;
    nextMutation = randExp(lambdaBase);
    lastTime = 0;
    initCodons();
    drawBackground();
    drawChain();
    updateStats();
  }
  
  // Event listeners
  document.getElementById('gene-lambda').addEventListener('input', function(e) {
    lambdaBase = parseFloat(e.target.value);
    document.getElementById('gene-lambda-val').textContent = lambdaBase;
    updateParamsText();
  });
  
  document.getElementById('gene-ratio').addEventListener('input', function(e) {
    hotspotRatio = parseInt(e.target.value);
    document.getElementById('gene-ratio-val').textContent = hotspotRatio + '×';
    updateParamsText();
  });
  
  document.getElementById('gene-start').addEventListener('click', function() {
    running = !running;
    this.textContent = running ? '⏸ Pausar' : '▶ Iniciar';
    this.classList.toggle('active', running);
    if (running) {
      lastTime = 0;
      requestAnimationFrame(loop);
    }
  });
  
  document.getElementById('gene-reset').addEventListener('click', function() {
    running = false;
    document.getElementById('gene-start').textContent = '▶ Iniciar';
    document.getElementById('gene-start').classList.remove('active');
    reset();
  });
  
  // Init
  initCodons();
  reset();
  updateParamsText();
})();
</script> <script>
  document.addEventListener("DOMContentLoaded", function() {
    var darkLayout = {
      paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.2)',
      font: { color: '#94a3b8', family: 'Manrope, sans-serif' },
      margin: { t: 30, b: 50, l: 60, r: 20 },
      xaxis: { gridcolor: 'rgba(255,255,255,0.05)' },
      yaxis: { gridcolor: 'rgba(255,255,255,0.05)' }
    };
    
    // Hotspots
    var hotspots = window.hotspotsCodones;
    Plotly.newPlot('chart-hotspots', [{
      x: hotspots.map(h => 'Codón ' + h.codon), y: hotspots.map(h => h.eventos / 1000000), type: 'bar',
      marker: { color: hotspots.map((h,i) => i < 3 ? '#f43f5e' : '#22d3ee') },
      text: hotspots.map(h => 'λ=' + h.lambda.toFixed(0)), textposition: 'outside'
    }], Object.assign({}, darkLayout, { yaxis: { ...darkLayout.yaxis, title: 'Millones de eventos' }, height: 350 }), { responsive: true });
    
    // CpG
    var cpg = window.cpgComparison;
    Plotly.newPlot('chart-cpg', [{
      labels: ['Sitios CpG', 'No-CpG'], values: [cpg.lambdaCpg, cpg.lambdaNoCpg], type: 'pie',
      marker: { colors: ['#f43f5e', '#22d3ee'] }, texttemplate: '%{label}<br>λ=%{value:.0f}'
    }], Object.assign({}, darkLayout, { height: 300, showlegend: false }), { responsive: true });
    
    // Enfermedades
    var enf = window.enfermedadLambda;
    Plotly.newPlot('chart-disease', [{
      y: enf.map(e => e.enfermedad), x: enf.map(e => e.lambda), type: 'bar', orientation: 'h',
      marker: { color: enf.map(e => e.lambda), colorscale: [[0, '#22d3ee'], [1, '#f43f5e']] }
    }], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Tasa λ' }, height: 350, margin: { l: 100 } }), { responsive: true });
    
    // Temporal - λ(t) = 10,769.5 - 4.82·t, R² = 0.184, p = 0.026
    var xYears = [1989, 1990, 1991, 1992, 1993, 1994, 1995, 1996, 1997, 1998, 1999, 2000, 2001, 2002, 2003, 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2013, 2014, 2015, 2016];
    var yLambdas = [1180, 1250, 1320, 1200, 1150, 1280, 1180, 1220, 1100, 1080, 1150, 1200, 1050, 1120, 1080, 1040, 1000, 1100, 1050, 1020, 980, 950, 1000, 980, 920, 950, 900, 880];
    
    // Línea de tendencia DECRECIENTE: λ(t) = 10,769.5 - 4.82·t
    var yTrend = xYears.map(function(y) { return 10769.5 - 4.82 * y; });
    
    Plotly.newPlot('chart-temporal', [
      { 
        x: xYears, 
        y: yLambdas, 
        type: 'scatter', 
        mode: 'markers', 
        name: 'λ observado', 
        marker: { color: '#3b82f6', size: 11 } 
      },
      { 
        x: xYears, 
        y: yTrend, 
        type: 'scatter', 
        mode: 'lines', 
        name: 'Tendencia: λ(t) = 10,769.5 - 4.82t (p=0.026)', 
        line: { color: '#ef4444', width: 2, dash: 'dash' } 
      }
    ], {
      paper_bgcolor: 'rgba(0,0,0,0)',
      plot_bgcolor: 'rgba(0,0,0,0.2)',
      font: { color: '#94a3b8', family: 'Manrope, sans-serif' },
      margin: { t: 40, b: 50, l: 60, r: 20 },
      xaxis: { title: 'Año', gridcolor: 'rgba(255,255,255,0.05)', dtick: 5 },
      yaxis: { title: 'λ Promedio', gridcolor: 'rgba(255,255,255,0.05)', range: [700, 1400] },
      height: 380,
      showlegend: true,
      legend: { x: 0.5, y: 1.1, xanchor: 'center', orientation: 'h' }
    }, { responsive: true });
    
    // KaTeX
    function tryKaTeX() {
      if (typeof katex === 'undefined') { setTimeout(tryKaTeX, 100); return; }
      var formulas = { 'formula-hom': 'P(N(t)=k) = \\frac{(\\lambda t)^k e^{-\\lambda t}}{k!}', 'formula-nhom': '\\lambda(t) = \\lambda_0 + b \\cdot t', 'model-temporal': '\\lambda(t) = 10769.5 - 4.82 \\cdot t' };
      Object.keys(formulas).forEach(id => { var el = document.getElementById(id); if (el) katex.render(formulas[id], el, { displayMode: true, throwOnError: false }); });
    }
    tryKaTeX();
  });
</script> <script>
  // Simulador de mutaciones
  document.addEventListener("DOMContentLoaded", function() {
    var lambdaInput = document.getElementById('sim-lambda'), slopeInput = document.getElementById('sim-slope'), timeInput = document.getElementById('sim-time'), runBtn = document.getElementById('sim-run');
    
    function updateLabels() {
      document.getElementById('sim-lambda-val').textContent = lambdaInput.value + ' mut/año';
      document.getElementById('sim-slope-val').textContent = parseFloat(slopeInput.value).toFixed(1);
      document.getElementById('sim-time-val').textContent = timeInput.value + ' años';
    }
    lambdaInput.addEventListener('input', updateLabels);
    slopeInput.addEventListener('input', updateLabels);
    timeInput.addEventListener('input', updateLabels);
    
    function generateHomogeneousPoisson(lambda, maxTime) {
      var events = [], t = 0;
      while (t < maxTime) { t += -Math.log(Math.random()) / lambda; if (t < maxTime) events.push({ time: t, codon: Math.floor(Math.random() * 393) + 1 }); }
      return events;
    }
    
    function generateNonHomogeneousPoisson(lambda0, slope, maxTime) {
      var events = [], lambdaMax = Math.max(lambda0, lambda0 + slope * maxTime), t = 0;
      while (t < maxTime) {
        t += -Math.log(Math.random()) / lambdaMax;
        if (t < maxTime) { var lambdaT = Math.max(0.1, lambda0 + slope * t); if (Math.random() <= lambdaT / lambdaMax) events.push({ time: t, codon: Math.floor(Math.random() * 393) + 1 }); }
      }
      return events;
    }
    
    function getIntervals(events) { var intervals = []; for (var i = 1; i < events.length; i++) intervals.push(events[i].time - events[i-1].time); return intervals; }
    function getCodonColor(codon) { return [175, 248, 273, 282, 245].includes(codon) ? '#f43f5e' : '#22d3ee'; }
    
    var darkLayout = { paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.15)', font: { color: '#94a3b8', size: 11 }, margin: { t: 10, b: 40, l: 50, r: 20 }, xaxis: { gridcolor: 'rgba(255,255,255,0.05)' }, yaxis: { gridcolor: 'rgba(255,255,255,0.05)' } };
    
    function runMutationSimulation() {
      var lambda = parseFloat(lambdaInput.value), slope = parseFloat(slopeInput.value), maxTime = parseInt(timeInput.value);
      var eventsHom = generateHomogeneousPoisson(lambda, maxTime), eventsNHom = generateNonHomogeneousPoisson(lambda, slope, maxTime);
      
      document.getElementById('stat-hom-count').textContent = eventsHom.length;
      document.getElementById('stat-nhom-count').textContent = eventsNHom.length;
      var diff = ((eventsNHom.length - eventsHom.length) / eventsHom.length * 100).toFixed(1);
      document.getElementById('stat-diff').textContent = (diff > 0 ? '+' : '') + diff + '%';
      
      Plotly.newPlot('chart-mutations-hom', [{ x: eventsHom.map(e => e.time), y: eventsHom.map(e => e.codon), mode: 'markers', type: 'scatter', marker: { size: 6, color: eventsHom.map(e => getCodonColor(e.codon)), opacity: 0.7 } }], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Tiempo (años)', range: [0, maxTime] }, yaxis: { ...darkLayout.yaxis, title: 'Codón', range: [0, 400] }, height: 260 }), { responsive: true });
      
      Plotly.newPlot('chart-mutations-nhom', [{ x: eventsNHom.map(e => e.time), y: eventsNHom.map(e => e.codon), mode: 'markers', type: 'scatter', marker: { size: 6, color: eventsNHom.map(e => getCodonColor(e.codon)), opacity: 0.7 } }], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Tiempo (años)', range: [0, maxTime] }, yaxis: { ...darkLayout.yaxis, title: 'Codón', range: [0, 400] }, height: 260 }), { responsive: true });
      
      var cumHom = [], cumNHom = [], timePoints = [];
      for (var i = 0; i <= maxTime * 10; i++) { var t = i / 10; timePoints.push(t); cumHom.push(eventsHom.filter(e => e.time <= t).length); cumNHom.push(eventsNHom.filter(e => e.time <= t).length); }
      
      Plotly.newPlot('chart-cumulative', [
        { x: timePoints, y: cumHom, type: 'scatter', mode: 'lines', name: 'Homogéneo', line: { color: '#22d3ee', width: 3 }, fill: 'tozeroy', fillcolor: 'rgba(34,211,238,0.1)' },
        { x: timePoints, y: cumNHom, type: 'scatter', mode: 'lines', name: 'No Homogéneo', line: { color: '#f43f5e', width: 3 }, fill: 'tozeroy', fillcolor: 'rgba(244,63,94,0.1)' }
      ], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Tiempo (años)' }, yaxis: { ...darkLayout.yaxis, title: 'N(t) Acumuladas' }, height: 300, showlegend: true, legend: { x: 0.02, y: 0.98, bgcolor: 'rgba(0,0,0,0.5)' } }), { responsive: true });
      
      var intervalsHom = getIntervals(eventsHom), intervalsNHom = getIntervals(eventsNHom);
      Plotly.newPlot('chart-intervals-hom', [{ x: intervalsHom, type: 'histogram', nbinsx: 20, marker: { color: '#22d3ee' } }], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Intervalo (años)' }, yaxis: { ...darkLayout.yaxis, title: 'Frecuencia' }, height: 220 }), { responsive: true });
      Plotly.newPlot('chart-intervals-nhom', [{ x: intervalsNHom, type: 'histogram', nbinsx: 20, marker: { color: '#f43f5e' } }], Object.assign({}, darkLayout, { xaxis: { ...darkLayout.xaxis, title: 'Intervalo (años)' }, yaxis: { ...darkLayout.yaxis, title: 'Frecuencia' }, height: 220 }), { responsive: true });
    }
    
    runBtn.addEventListener('click', runMutationSimulation);
    lambdaInput.addEventListener('change', runMutationSimulation);
    slopeInput.addEventListener('change', runMutationSimulation);
    timeInput.addEventListener('change', runMutationSimulation);
    runMutationSimulation();
  });
</script> <script>
  // Simulador de Proceso de Poisson Compuesto
  document.addEventListener("DOMContentLoaded", function() {
    var lambdaCompInput = document.getElementById('comp-lambda');
    var muInput = document.getElementById('comp-mu');
    var timeCompInput = document.getElementById('comp-time');
    var runCompBtn = document.getElementById('comp-run');
    
    function updateCompLabels() {
      document.getElementById('comp-lambda-val').textContent = lambdaCompInput.value + ' tumores/u.t.';
      document.getElementById('comp-mu-val').textContent = parseFloat(muInput.value).toFixed(2);
      document.getElementById('comp-time-val').textContent = timeCompInput.value + ' u.t.';
    }
    lambdaCompInput.addEventListener('input', updateCompLabels);
    muInput.addEventListener('input', updateCompLabels);
    timeCompInput.addEventListener('input', updateCompLabels);
    
    // Generar número de mutaciones por tumor (geométrica desplazada para simular datos reales)
    function generateMutationsPerTumor(meanMuts) {
      // Usar distribución geométrica modificada (84% prob de 1, resto distribuido)
      var r = Math.random();
      if (r < 0.84) return 1;
      else if (r < 0.96) return 2;
      else if (r < 0.98) return 3;
      else if (r < 0.99) return 4;
      else return Math.floor(Math.random() * 4) + 5;
    }
    
    function generateCompoundPoisson(lambda, muX, maxTime) {
      var tumors = [];
      var totalMuts = 0;
      var t = 0;
      
      while (t < maxTime) {
        t += -Math.log(Math.random()) / lambda;
        if (t < maxTime) {
          var muts = generateMutationsPerTumor(muX);
          tumors.push({ time: t, mutations: muts });
          totalMuts += muts;
        }
      }
      return { tumors: tumors, totalMutations: totalMuts };
    }
    
    var darkLayout = {
      paper_bgcolor: 'rgba(0,0,0,0)', plot_bgcolor: 'rgba(0,0,0,0.15)',
      font: { color: '#94a3b8', size: 11 },
      margin: { t: 10, b: 40, l: 50, r: 20 },
      xaxis: { gridcolor: 'rgba(255,255,255,0.05)' },
      yaxis: { gridcolor: 'rgba(255,255,255,0.05)' }
    };
    
    function runCompoundSimulation() {
      var lambda = parseFloat(lambdaCompInput.value);
      var muX = parseFloat(muInput.value);
      var maxTime = parseInt(timeCompInput.value);
      
      var result = generateCompoundPoisson(lambda, muX, maxTime);
      var tumors = result.tumors;
      var totalMuts = result.totalMutations;
      var expectedS = lambda * maxTime * muX;
      
      document.getElementById('stat-tumors').textContent = tumors.length;
      document.getElementById('stat-total-muts').textContent = totalMuts;
      document.getElementById('stat-expected').textContent = expectedS.toFixed(0);
      
      // Gráfico de proceso acumulado
      var timePoints = [];
      var cumTumors = [];
      var cumMuts = [];
      
      for (var i = 0; i <= maxTime * 10; i++) {
        var t = i / 10;
        timePoints.push(t);
        var nTumors = tumors.filter(tu => tu.time <= t).length;
        var sMuts = tumors.filter(tu => tu.time <= t).reduce((sum, tu) => sum + tu.mutations, 0);
        cumTumors.push(nTumors);
        cumMuts.push(sMuts);
      }
      
      // Línea teórica E[S(t)] = λt·μ
      var theoreticalS = timePoints.map(t => lambda * t * muX);
      
      Plotly.newPlot('chart-compound-cumulative', [
        { x: timePoints, y: cumTumors, type: 'scatter', mode: 'lines', name: 'N(t) Tumores', line: { color: '#22d3ee', width: 2 } },
        { x: timePoints, y: cumMuts, type: 'scatter', mode: 'lines', name: 'S(t) Mutaciones', line: { color: '#f43f5e', width: 3 } },
        { x: timePoints, y: theoreticalS, type: 'scatter', mode: 'lines', name: 'E[S(t)] = λt·μ', line: { color: '#a78bfa', width: 2, dash: 'dash' } }
      ], Object.assign({}, darkLayout, {
        xaxis: { ...darkLayout.xaxis, title: 'Tiempo' },
        yaxis: { ...darkLayout.yaxis, title: 'Conteo' },
        height: 320,
        showlegend: true,
        legend: { x: 0.02, y: 0.98, bgcolor: 'rgba(0,0,0,0.5)' }
      }), { responsive: true });
      
      // Distribución de mutaciones por tumor (simulada)
      var mutsCounts = {};
      tumors.forEach(function(tu) {
        mutsCounts[tu.mutations] = (mutsCounts[tu.mutations] || 0) + 1;
      });
      var xMuts = Object.keys(mutsCounts).map(Number).sort((a,b) => a-b);
      var yFreq = xMuts.map(x => mutsCounts[x]);
      
      Plotly.newPlot('chart-compound-dist', [{
        x: xMuts, y: yFreq, type: 'bar',
        marker: { color: xMuts.map(x => x === 1 ? '#22d3ee' : '#f43f5e') },
        text: yFreq.map(f => f.toString()), textposition: 'outside'
      }], Object.assign({}, darkLayout, {
        xaxis: { ...darkLayout.xaxis, title: 'Mutaciones/Tumor', dtick: 1 },
        yaxis: { ...darkLayout.yaxis, title: 'Frecuencia' },
        height: 260
      }), { responsive: true });
    }
    
    // Gráfico de datos reales de complejidad
    function plotRealComplexity() {
      var data = window.datosCompuesto;
      if (!data) return;
      
      var comp = data.complejidad;
      Plotly.newPlot('chart-real-complexity', [{
        labels: comp.map(c => c.tipo),
        values: comp.map(c => c.porcentaje),
        type: 'pie',
        marker: { colors: ['#22d3ee', '#f43f5e', '#a78bfa', '#fbbf24'] },
        textinfo: 'label+percent',
        hole: 0.4
      }], Object.assign({}, darkLayout, {
        height: 260,
        showlegend: false,
        annotations: [{ text: '84%<br>Simple', x: 0.5, y: 0.5, font: { size: 14, color: '#22d3ee' }, showarrow: false }]
      }), { responsive: true });
    }
    
    // KaTeX para fórmulas del compuesto
    function renderCompoundFormulas() {
      if (typeof katex === 'undefined') { setTimeout(renderCompoundFormulas, 100); return; }
      var formulaES = document.getElementById('formula-es');
      var formulaVar = document.getElementById('formula-var');
      if (formulaES) katex.render('E[S(t)] = \\lambda t \\cdot E[X]', formulaES, { displayMode: false, throwOnError: false });
      if (formulaVar) katex.render('Var[S(t)] = \\lambda t \\cdot E[X^2]', formulaVar, { displayMode: false, throwOnError: false });
    }
    
    runCompBtn.addEventListener('click', runCompoundSimulation);
    lambdaCompInput.addEventListener('change', runCompoundSimulation);
    muInput.addEventListener('change', runCompoundSimulation);
    timeCompInput.addEventListener('change', runCompoundSimulation);
    
    runCompoundSimulation();
    plotRealComplexity();
    renderCompoundFormulas();
  });
</script> 